<!DOCTYPE html>
<html>
<head>
<title>
Asset Manager Quest (DotGraph)
</title>
<meta charset="utf-8">
<style>
 body {margin:3%;}
 tw-storydata {display:none;}
 #stats {font-style:italic;text-align:center;}
 input#omitTags, input#clusterTags {width:30%;}
 label {white-space:nowrap;}
 div#notes {font-size:smaller;width:40%;padding-top:10px;float:right;}
 h2 {float:left;padding-right:3em;}
 section {clear:both;}
 textarea {min-height:15em;}
 #graphSection {text-align:center;}
 #saveSvgButton {float:left;}
 #scaleInput {width:5em;}
 #scaleUpButton, #scaleDownButton {font-weight:bold;}
</style>
<script src="https://mcdemarco.net/tools/viz/viz.js" type="text/javascript"></script><script src="https://mcdemarco.net/tools/viz/full.render.js" type="text/javascript"></script>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Asset Manager Quest</title>
<link rel="apple-touch-icon" sizes="180x180" href="icon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="icon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="icon/favicon-16x16.png">
<link rel="shortcut icon" href="icon/favicon.ico">
<link rel="manifest" href="icon/site.webmanifest">
<link rel="mask-icon" href="icon/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#08104f">
<meta name="theme-color" content="#ff86cc">

<meta name="title" content="Asset Manager Quest">
<meta name="description" content="Invest in the planet, or let it burn! Let's play Asset Manager Quest">
<meta name="keywords" content="asset manager, abrdn, game">
<meta name="robots" content="index, follow">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="language" content="English">
<meta name="author" content="Oli Frost">

<meta property="og:title" content="Asset Manager Quest">
<meta property="og:type" content="game">
<meta property="og:description" content="Invest in the planet, or let it burn! Let's play Asset Manager Quest">
<meta property="og:image" content="https://www.assetmanager.quest/cover.png">
<meta property="og:url" content="assetmanager.quest">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Asset Manager Quest">
<meta name="twitter:site" content="@olifro_st">
<meta name="twitter:description" content="Invest in the planet, or let it burn! Let's play Asset Manager Quest">
<meta name="twitter:image" content="https://www.assetmanager.quest/cover.png">
<meta name="twitter:image:alt" content="abrdn">
</head>
<body>
	<h1>DotGraph Proof of Asset Manager Quest</h1>

	<div id="stats" title="Twine">
		<span id="nodeCount">0</span>&nbsp;nodes<span id="omitCount"></span>,
		<span id="leafCount">0</span>&nbsp;leaves<span id="looseCount"></span>,
		<span id="linkCount">0</span>&nbsp;links, and
		<span id="average">0</span>&nbsp;links&nbsp;per&nbsp;node.
	</div>

	<h2 id="settingsHeader" style="text-decoration:underline;">Settings</h2>
	<section id="settingsSection">
		<div id="notes">
						<p><b>Notes:</b> The start node is double-circled, as are any unreachable nodes.  When color by length is on, all real nodes are colored in shades of red (shorter than average) to blue (longer than average) based on the relative length of their contents.</p>
						<p>Stray or misplaced nodes can result from the omit tags setting, from duplicate passage names, scripted passage transitions, or other linking issues.</p>
						<p>The layout engine options change the graph style; some options are slower than the default ("dot").  The image format is SVG.  For more information, see <a href="http://mcdemarco.net/tools/scree/dotgraph/">the website</a> or <a href="https://bitbucket.org/mcdemarco/dotgraph/src/default/README.md">the README</a>.</p>
		</div>
	<div>
		<form id="settingsForm">
		</form>
	</div>
	</section>

	<h2 id="graphHeader">Graph</h2>
	<section id="graphSection">
		<button type="button" id="saveSvgButton">Save Image</button>
		<label for="scaleCheckbox">Scale:</label>&nbsp;<input type="text" id="scaleInput" value="" />
		<button type="button" id="scaleDownButton">&ndash;</button>
		<button type="button" id="scaleUpButton">+</button>
		<div id="graph"></div>
		<hr style="clear:both;"/>
	</section>

	<h2 id="dotHeader" style="text-decoration:underline;">Dot Source</h2>
	<section id="dotSection">

		<p>
			If rendering of the graph fails (i.e., you only see the dot source file) or you need the output in a different format, the dot source can also be rendered using the free desktop program <a href="http://www.graphviz.org/">Graphviz</a>, or rendered online at <a href="http://stamm-wilbrandt.de/GraphvizFiddle/">GraphvizFiddle</a>, <a href="http://www.webgraphviz.com">WebGraphviz</a>, or <a href="http://viz-js.com">Viz.js</a>.
		</p>

		<button type="button" id="editButton">Redraw with edits</button>
		<button type="button" id="saveDotButton">Save Source</button><br/>
	
		<textarea id="dotfile" style="width:100%;height:10em;"></textarea>
	</section>

<!-- UUID://CC9F1D48-504F-4DC3-86F4-37E120FB9203// --><tw-storydata name="Asset Manager Quest" startnode="66" creator="Tweego" creator-version="2.1.1+81d1d71" ifid="CC9F1D48-504F-4DC3-86F4-37E120FB9203" zoom="0.6" format="DotGraph" format-version="2.2.0" options="" hidden><style role="stylesheet" id="twine-user-stylesheet" type="text/twine-css">@import url("modules/animate.min.css");
@font-face {
  font-display: swap;
  font-family: 'Jersey 10';
  font-style: normal;
  font-weight: 400;
  src: url('font/jersey-10-v2-latin-regular.woff2') format('woff2');
}
@font-face {
    font-family: 'lores-12';
    src: url('font/LoRes12OT-Regular.woff2') format('woff2'),
        url('font/LoRes12OT-Regular.woff') format('woff');
    font-weight: 500;
    font-style: normal;
    font-display: swap;
}

/* Wrapper */
 .hidden {
        display: none;
   		margin: auto;
}
.nb {
	white-space: nowrap;  
}
 body {
     display: flex;
     font-family: "lores-12","DotGothic16", monospace;
     letter-spacing: 0.5px;
     font-weight: normal;
     font-size: 1.5em;
     background-color: #00094a;
}

#init-screen {
  background-color: #00094a;
   color: #FDA0D9; 
}
 body a {
     color: #FDA0D9; 
}
 h1, h2, h3 {
     margin: 0;
     font-family: "Jersey 10", monospace;
   font-weight: 400;
}
/* Banner */
 .header {
     width: 100%;
}
/* Menu */
 .menu {
     display: flex;
     background-color: #FB008C;
     border-bottom: 3px solid #9b9eb1;
     font-size: 1rem;
     flex-direction: row-reverse;
}
 .logo-bar, .menu-options {
     height: 2rem;
}
 .menu svg path {
     fill: white;
}
/* Menu */
 .menu-options {
     max-width: 19em;
     display: flex;
     flex: 1;
}
 .menu-options img, .menu-options svg {
     height: 1rem;
     width: 1rem;
}
 .menu-options a {
     background-color: #ff86cc;
     color: #FB008C;
     font-size: 0.8rem;
     transition: background-color 0.3s;
     display: flex;
     justify-content: center;
     align-items: center;
     flex: 1;
     border-right: 1px solid #ff1899; 
}
 @media (hover: hover) {
     .menu-options a:hover {
         background-color: #ff1899;
         text-decoration: none;
    }
   a:hover {
     color: #ff1899;
     text-decoration: none;
   }
}
/* Logo */
 .logo-bar {
     display: flex;
     flex: 1;
     background-color: #4d5275;
     justify-content: flex-end;
}
 #small-logo {
     display: flex;
     background-color: #4d5275;
     width: 19rem;
}
 #small-logo img {
     height: 60%;
     margin: auto;
     position: relative;
     right: -1rem;
}
/* Differnt Colour Intro */
 .menu a[data-passage="Intro"] {
     background-color: #ff1899;
     color: white;
}
 .menu a[data-passage="Intro"]:hover {
     background-color: #9b9eb1;
     color: white;
}
 .menu a[data-passage="Who"]:hover {
     color: white;
}
/* Fix Icon */
 .menu a[data-passage="abrdn"] svg {
     height: 35%;
}

/* Banner */
 #banner {
     display: flex;
     background-image: url("img/grid.png");
     background-position: bottom;
     background-repeat: no-repeat;
     background-size: cover;
     background-size: 100% 50%;
     border-bottom: 3px solid #9b9eb1;
     height: 100px;
    animation: sway 5s infinite alternate;
   animation-timing-function: ease-in-out;
}

@keyframes sway {
    0% {
        background-position-x: 0;
    }
    100% {
        background-position-x: 20px; /* Adjust the value to control the sway distance */
    }
}
 #banner div {
     flex: 1;
}
 #banner-left img, #banner-right img, #banner-logo img {
     max-height: 100px;
}
 #banner-logo img {
     height: 120%;
     margin: auto;
}
 #banner-logo {
     display: flex;
}
 #banner-right img {
     float: right;
}
/* Main Text */
 .game-container {
     display: flex;
     flex-direction: column;
     align-items: center;
     background-color: #070C4E;
     border-right: 3px solid #9b9eb1;
     border-left: 3px solid #9b9eb1;
     width: 100%;
     max-width: 1800px;
     min-height: 100vh;
     height: 100%;
     margin-left: auto;
     margin-right: auto;
}
 .game-content {
     width: 100%;
     display: flex;
     justify-content: center;
}
 #passages {
     padding: 1rem;
     padding-top: 1rem;
}
 .passage {
     text-align: center;
     padding-top: 1rem;
     max-width: 1200px;
     line-height: 1.8rem;
}
 #passages h1 {
     font-size: 3rem;
     line-height: 3rem;
     margin-bottom: 1.5rem;
}
 #passages input {
     width: 95%;
     min-width: 0em;
     border: 2px solid #ff86cc;
}
input,
input:not(:disabled):focus,
input:not(:disabled):hover,
select,
select:not(:disabled):focus,
select:not(:disabled):hover,
textarea,
textarea:not(:disabled):focus,
textarea:not(:disabled):hover{
    background-color: #4d5275;
}
#passages img {
  margin-left: auto;
  margin-right: auto;
  width: 13em;
  margin-bottom: -2em;
  position:relative;
  bottom: 2rem;
}

#passages #gameover img {
    width: 15em;
  margin-bottom: -2em;
  bottom: 1.5rem;
}
/* Choices */
.selected {
      background-color: #FB008C !important;
      border-bottom: 2px solid #c7026e!important;
    }

 .passage ol {
     font-family: "Jersey 10";
     margin: 0;
     margin-top: 2rem;
     font-size: 2rem;
     list-style-type: none;
     padding: 0;
     width: 100%;
}
 .passage ol a, .passage ol .locked {
     display: flex;
     align-items: center;
     justify-content: center;
     background-color: #ff86cc;
     border-bottom: 2px solid #FECFEA;
     padding: 20px;
     color: #00094a;
     transition: background-color 0.3s, border-bottom 0.3s, transform 0.3s;
     font-size: 1em;
     line-height: 2rem;
     margin-bottom: 0.5em;
   text-decoration: none !important;
}
 @media (hover: hover) {
     .passage ol a:hover {
         background-color: #ff86cc;
         transform: scale(1.05);
         text-decoration: none;
    }
     .passage ol .locked:hover {
     background-color: #8C8EA5;
     transform: scale(1);
     cursor: default;
}
}
 .passage ol .locked {
     background-color: #8C8EA5;
     border-bottom: 2px solid #565673;
     color: white;
}
 button {
     background-color: #FDA0D9;
     border-radius: 2px;
     color: #08053E;
     border: 0;
     padding: 5px 15px;
     border-bottom: 2px solid #FECFEA;
}
 button:hover {
     background-color: #F60079;
     border-bottom: 2px solid #FECFEA;
     color: white;
}
 .floating {
     animation-name: floating;
     animation-duration: 1.5s;
     animation-iteration-count: infinite;
     animation-timing-function: ease-in-out;
     margin-top: 0px;
}
 @keyframes floating {
     0% {
         transform: translate(0, 0px);
    }
     50% {
         transform: translate(0, 5px);
    }
     100% {
         transform: translate(0, -0px);
    }
}
/* Splash Screen */
 #splash-screen {
     position: fixed;
     left: 0;
     top: 0;
     right: 0;
     bottom: 0;
     z-index: 100;
     background-color: #050630;
     color: #eee;
     display: flex;
     align-items: center;
     justify-content: center;
     background-position: center;
   background-image: url("img/AMQ-Title-BG.png");
   background-size: cover;
    /* Center the image */
     background-repeat: no-repeat;
       animation: zoomin 5s 1;
}
 @media (min-width: 1200px){
      #splash-screen {
             background-image: url("img/AMQ-Title-BG-Wide.png");
           	background-size: auto 100%;
    }
}
 @media (min-width: 1600px){
      #splash-screen {
             background-image: url("img/AMQ-Title-BG-UltraWide.png");
    }
}
@keyframes zoomin {
  0% {
    background-size: auto 100%;
  }
  100% {
    background-size: auto 105%;
  }
}


 #splash-logo {
     display: block;
     text-align: center;
     position: relative;
     bottom: 2.5rem; 
}
 #splash-logo img {
   	width: 100%;
	width: 25rem;
}
 #splash-logo > p {
     display: block;
     position: relative;
     bottom: 1rem;
     left: 1rem;
}
 @media (min-width: 620px){
     .optional-br {
         display: none;
    }
   .game-container {
     border-top: 3px solid #9b9eb1;
     -webkit-border-top-left-radius: 4px;
border-top-left-radius: 4px;
border-top-right-radius: 4px;
   }
}
 @media (max-width: 620px) {
     .menu {
         display: block;
    }
     .menu-options {
         max-width: 100%;
    }
     .logo-bar {
         justify-content: center;
    }
     #small-logo img {
         right: 0;
    }
     #banner, .menu, .game-container {
         border-width: 1px;
    }
   .game-container {
     border: none;
   }
    #splash-logo img {
      width: 20rem;
   }
}
/* Larger Screens */
 @media (min-width: 1200px){
     #banner, #banner-left img, #banner-right img, #banner-logo img {
         height: 150px;
         max-height: 150px;
    }
}
 @media (min-width: 1500px){
     #banner, #banner-left img, #banner-right img, #banner-logo img {
         height: 200px;
         max-height: 200px;
    }
      html {
     font-size: 150% !important;
   }
}
/*.passage {
     color: #fff;
     text-shadow: 0px 0px 20px #fff;
     font-size: 20px;
     line-height: 22px;
}
 .passage a, .passage a:hover, .passage a:active {
     color: #fff;
     text-shadow: 0px 0px 20px #fff;
}
*/
/* Horizontal Health Bar - Start */
 .hzbarbkg {
    /* default class for all horizontal bar backgrounds */
     position: relative;
     height: 15px;
     width: 100%;
     background-color: #4d5275;
     border-radius: 10px;
     z-index: 10;
     visibility: visible;
}
 .hzbar {
    /* default class for all horizontal bars */
     position: absolute;
     bottom: 0px;
     left: 0px;
     height: 15px;
     background-color: #ff86cc;
     border-radius: 10px;
     z-index: 20;
     transition: width ease 3s, background-color ease 3s;
}
/* Horizontal Health Bar - End */

.drunk {
     animation: drunkCam 10s infinite alternate;
     color: white;
}
 @keyframes drunkCam {
     0% {
         filter: blur(0px);
         text-shadow: 0 0 0 grey;
    }
     20% {
         filter: blur(1px);
         text-shadow: 8px 0 0 grey;
    }
     24% {
         filter: blur(0px);
         text-shadow: 0 0 0 grey;
    }
     26% {
         filter: blur(0px);
         text-shadow: 0 0 0 grey;
    }
     28% {
         filter: blur(1px);
         text-shadow: 10px 0 0 grey;
    }
     30% {
         filter: blur(0px);
         text-shadow: 0 0 0 grey;
    }
     60% {
         filter: blur(1px);
         text-shadow: 5px 0 0 grey;
    }
     62% {
         filter: blur(0px);
         text-shadow: 0 0 0 grey;
    }
     65% {
         filter: blur(2px);
         text-shadow: 8px 0 0 grey;
    }
     67% {
         filter: blur(0px);
         text-shadow: 0 0 0 grey;
    }
     80% {
         filter: blur(0px);
         text-shadow: 8px 0 0 grey;
    }
     85% {
         filter: blur(2px);
         text-shadow: 10px 0 0 grey;
    }
     88% {
         filter: blur(1px);
         text-shadow: 5px 0 0 grey;
    }
     90% {
         filter: blur(0px);
         text-shadow: 0 0 0 grey;
    }
}
/* Drunk Text - End */</style><script role="script" id="twine-user-script" type="text/twine-javascript">/* twine-user-script #1: "StoryScript" */
// Do not type on previously visited passages
Config.macros.typeVisitedPassages = false;

// No Return
$(document).on(':passagestart', function (ev) {
	if (!ev.passage.tags.includes('noreturn')) {
		State.variables.return = ev.passage.title;
	}
});

function CopyToClipboard(id)
{
var r = document.createRange();
r.selectNode(document.getElementById(id));
window.getSelection().removeAllRanges();
window.getSelection().addRange(r);
document.execCommand('copy');
window.getSelection().removeAllRanges();
}

//Clipboard
function myFunction() {
  // Get the text field
  var copyText = document.getElementById("myInput");

  // Select the text field
  copyText.select();
  copyText.setSelectionRange(0, 99999); // For mobile devices

  // Copy the text inside the text field
  navigator.clipboard.writeText(copyText.value);
  
  // Alert the copied text
  alert("Copied the text: " + copyText.value);
}
// Sound
setup.Path = "";  // Running in a browser
setup.ImagePath = setup.Path + "image/";
setup.SoundPath = setup.Path + "sound/";

// Check to see if trackID is currently loaded
window.TrackExists = function (trackID) {
	return SimpleAudio.tracks.has(trackID);
};

// Check to see if trackID is the currently playing track
window.isPlaying = function (trackID) {
	var track = SimpleAudio.tracks.get(trackID);
	return track !== null && track.isPlaying();
};

// Splash

(function () {
	// Duration of the splash image's fade in.
	var fadeIn  = 500; // in milliseconds

	// Delay before the splash screen begins to fade out.
	var linger  = 2000; // in milliseconds

	// Duration of the splash screen's fade out.
	var fadeOut = 1000; // in milliseconds

	// Splash image.
	var $image  = $('<span id="splash-logo"><img class="animate__animated animate__fadeInUp" src="img/AMQ-Rev.png"><p class="animate__animated animate__fadeInUp animate__delay-1s">Loading assets...</p></span>').hide();

	// Display the splash screen.
	$(document.body)
		.find('#splash-screen')
			.delay(linger)
			.fadeOut(fadeOut);

	// Set up the removal of the splash screen.
	setTimeout(function () {
		$('#splash-screen').remove();
	}, fadeIn + linger + fadeOut + 1000);
})();

// Death
Config.navigation.override = function (dest) {
	var sv = State.variables;
	// If $health is less-than-or-equal to 0, go to the "You Died" passage instead.
	if (sv.approval <= 0 && sv.invincible === false) {
		return "You Died";
	}
};

// Health Bar
window.Health = function (approval, maxapproval, BarID, Horizontal, Container) {
	if (Container == undefined) {
		Container = document;
	}
  
	var HP = parseInt((approval / maxapproval) * 100).clamp(0, 100);
	var BarElement = $(Container).find("#" + BarID);
	if (Horizontal) {
		BarElement.css({ width: approval + "%" });
	} else {
		BarElement.css({ height: approval + "%" });
	}
	BarElement.attr("title", approval + "/" + maxapproval + "");
	$(Container).find("#" + BarID + "bkg").attr("title", approval + "/" + maxapproval + "%");
};
/* twine-user-script #2: "splash.js" */
/* twine-user-script #3: "keyboard.js" */
document.addEventListener('keydown', function(event) {
    const key = event.key;
    const links = document.querySelectorAll('ol li a');

    if (key >= '1' && key <= '3') {
        /*const index = parseInt(key, 10) - 1; // Convert key to 0-based index
        if (links[index]) {
            links[index].click();
        }*/
    } else if (key === ']') {
        // Move down the list
        if (currentIndex < links.length - 1) {
            currentIndex++;
        } else {
            currentIndex = 0; // Wrap around to the top
        }
        updateSelection(links);
    } else if (key === '[') {
        // Move up the list
        if (currentIndex > 0) {
            currentIndex--;
        } else {
            currentIndex = links.length - 1; // Wrap around to the bottom
        }
        updateSelection(links);
    } else if (key === 'Enter') {
        // Select the current item
        if (currentIndex >= 0 && currentIndex < links.length) {
            links[currentIndex].click();
            currentIndex = -1;
            updateSelection(links); // Update selection to remove any highlight
        }
    }
});

let currentIndex = -1; // No item is selected initially

function updateSelection(links) {
    // Remove the selected class from all links
    links.forEach(link => link.classList.remove('selected'));

    // Add the selected class to the current link
    if (currentIndex >= 0 && currentIndex < links.length) {
        links[currentIndex].classList.add('selected');
        links[currentIndex].focus();
    }
}</script><tw-tag name="item" color="yellow"></tw-tag><tw-tag name="down" color="purple"></tw-tag><tw-tag name="success" color="green"></tw-tag><tw-tag name="danger" color="orange"></tw-tag><tw-tag name="ending" color="orange"></tw-tag><tw-tag name="rework" color="none"></tw-tag><tw-tag name="win" color="green"></tw-tag><tw-tag name="info" color="blue"></tw-tag><tw-tag name="unlock" color="yellow"></tw-tag><tw-tag name="noreturn" color="red"></tw-tag><tw-tag name="mystery" color="blue"></tw-tag><tw-tag name="damange" color="orange"></tw-tag><tw-tag name="nope" color="none"></tw-tag><tw-tag name="forest" color="green"></tw-tag><tw-tag name="title" color="green"></tw-tag><tw-passagedata pid="1" name="Blow in wind" tags="" position="2700,1575" size="100,100">You blow through the wind, majestically
# [[Remedy acidic soils]]
# [[Become a pile again|Stay as pile]]</tw-passagedata><tw-passagedata pid="2" name="Definitely remain ash" tags="" position="2875,1525" size="100,100">Ok, you&#39;re a pile of ash
# [[Blow in wind]]
# [[Remedy acidic soils]]
# [[Stay as pile]]</tw-passagedata><tw-passagedata pid="3" name="Keep living in forest" tags="damange" position="2300,1600" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Fire.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
The climate crisis deepens

You and your woodland camp is consumed by a &#39;&#39;wildfire&#39;&#39;
# [[Emerge from the flames]]
# [[Remain a pile of ash]]</tw-passagedata><tw-passagedata pid="4" name="Remain a pile of ash" tags="mystery" position="2875,1375" size="100,100">You&#39;ll just be some ash and that&#39;s it

Are you sure?
# [[Definitely remain ash]]
# [[Emerge from the flames]]</tw-passagedata><tw-passagedata pid="5" name="Stay as pile" tags="" position="3075,1625" size="100,100">You remain as a pile, for a while
# [[Blow in wind]]
# [[Remedy acidic soils]]
# [[Stay as pile]]</tw-passagedata><tw-passagedata pid="6" name="Ask staff for help with horse problem" tags="nope" position="2025,575" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/pony-zombie.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
Staff morale is &#39;&#39;&lt;&lt;print $approval&gt;&gt;%&#39;&#39;

&lt;&lt;approval&gt;&gt;
Due to &#39;&#39;low morale&#39;&#39;, the &#39;&#39;staff&#39;&#39; don&#39;t want to help
# [[Fire some staff|Fire workforce]]
# [[Fight undead horse alone]]
# [[Divest from fossil fuel industry|Fossil Fuel Policy][$invincible to true]]</tw-passagedata><tw-passagedata pid="7" name="Bring crying child to work" tags="success" position="750,400" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Child.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
The crying child explains to the board the impact of the climate crisis on future generations...
# [[It works!|Good End]]</tw-passagedata><tw-passagedata pid="8" name="Buy child Nintendo Switch" tags="nope" position="1700,200" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Child.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
&lt;&lt;type 20ms none&gt;&gt;\
The first game they play is called &#39;&#39;Asset Manager Quest&#39;&#39;

This brings up the whole climate crisis thing again

The &#39;&#39;child&#39;&#39; resumes &#39;&#39;crying&#39;&#39;
# &lt;&lt;if not hasVisited(&quot;Buy child pony&quot;)&gt;&gt;[[Buy child pony]]&lt;&lt;else&gt;&gt;[[Buy another pony|Buy child pony]]&lt;&lt;/if&gt;&gt;
# [[Go back for more pastries]]
# [[Implement fossil fuel exclusion policy|Fossil Fuel Policy][$invincible to true]]
&lt;&lt;/type&gt;&gt;\</tw-passagedata><tw-passagedata pid="9" name="Fight undead horse alone" tags="damange" position="2150,300" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/pony-zombie.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
Your fists are no match for its undead hooves
# [[Go to Asset Manager Heaven|Fly to the celestial realm]]</tw-passagedata><tw-passagedata pid="10" name="Go home to crying child" tags="item" position="1500,400" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Child.png&quot;&gt;&gt;
&lt;&lt;set $child to true&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
!!CRYING CHILD UNLOCKED!

The &#39;&#39;crying child&#39;&#39; seems to be upset

It might be worried about its &#39;&#39;future on earth&#39;&#39;
# [[Buy child Nintendo Switch]]
# [[Buy child pony]]
# [[Implement fossil fuel exclusion policy|Fossil Fuel Policy][$invincible to true]]</tw-passagedata><tw-passagedata pid="11" name="Named Pony" tags="nope" position="1900,400" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Pony-dead.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
It&#39;s a beautiful summer&#39;s day

Thanks to the climate crisis, $pony dies from heat exhaustion.

Your &#39;&#39;child&#39;&#39; is now &#39;&#39;crying&#39;&#39; again
# [[Resurrect pony][$undead to true]]
# [[Buy child Nintendo Switch]]
# [[Implement fossil fuel exclusion policy|Fossil Fuel Policy][$invincible to true]]</tw-passagedata><tw-passagedata pid="12" name="Resurrect pony" tags="mystery" position="2200,500" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/pony-zombie.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
&lt;&lt;type 20ms none&gt;&gt;\
You agree to help a necromancer manage their financial assets on the side

They resurrect $pony

Undead $pony comes for your family
# [[Fight undead horse alone]]
# [[Ask staff for help with horse problem]]
&lt;&lt;/type&gt;&gt;\</tw-passagedata><tw-passagedata pid="13" name="Resurrect" tags="noreturn item" position="2550,1225" size="100,100">!!CELESTIAL REALM UNLOCKED!

God resurrects you&lt;&lt;set $god to true&gt;&gt;

Your experience of the fragility of life readjusts your priorities
# [[Return to implement fossil fuel exclusion policy|Fossil Fuel Policy][$invincible to true]]</tw-passagedata><tw-passagedata pid="14" name="Call on celestial realm" tags="success" position="900,350" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Wings-flight.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
Angels fill the board room...

Using divine light, they show the board the impacts of the climate crisis
# [[It works!|Good End]]</tw-passagedata><tw-passagedata pid="15" name="Fossil Fuel Policy" tags="noreturn danger" position="700,75" size="200,200">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $invincible to false&gt;&gt;
&lt;&lt;set $image to &quot;img/Board.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
!FINAL BOSS
The board calls you into a meeting room

&quot;A policy against fossil fuel bonds? How dare you put the polar bears before our short term profits???&quot;&lt;span id=&quot;tip&quot;&gt;&lt;br&gt;&lt;br&gt;&#39;&#39;TIP:  [[Start again|Intro]] and unlock more defences&#39;&#39;&lt;/span&gt;
# [[Mention economic benefits]]
# [[Mention severity of climate crisis]]
# [[Mention company risk modelling|Risk]]
# &lt;&lt;if $league&gt;&gt;[[Summon League]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;locked&quot;&gt;Option Locked&lt;/span&gt;&lt;&lt;/if&gt;&gt;
# &lt;&lt;if $nature&gt;&gt;[[Use profound understanding of nature]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;locked&quot;&gt;Option Locked&lt;/span&gt;&lt;&lt;/if&gt;&gt;
# &lt;&lt;if $god&gt;&gt;[[Call on celestial realm]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;locked&quot;&gt;Option Locked&lt;/span&gt;&lt;&lt;/if&gt;&gt;
# &lt;&lt;if $child&gt;&gt;[[Bring crying child to work]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;locked&quot;&gt;Option Locked&lt;/span&gt;&lt;&lt;/if&gt;&gt;
# &lt;&lt;if $phoenix&gt;&gt;[[Using phoenix magic]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;locked&quot;&gt;Option Locked&lt;/span&gt;&lt;&lt;/if&gt;&gt;
# &lt;&lt;if $pastry&gt;&gt;[[Make everyone pastries]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;locked&quot;&gt;Option Locked&lt;/span&gt;&lt;&lt;/if&gt;&gt;
# &lt;&lt;if $shorts&gt;&gt;[[Show them your shorts]]&lt;&lt;else&gt;&gt;&lt;span class=&quot;locked&quot;&gt;Option Locked&lt;/span&gt;&lt;&lt;/if&gt;&gt;

&lt;script&gt;
$(document).one(&#39;:passagedisplay&#39;, function() {
    let listItems = document.querySelectorAll(&quot;ol li&quot;); 
    let parent = listItems[0].parentNode;

    let unlocked = Array.from(listItems).filter(el =&gt; !el.querySelector(&#39;.locked&#39;));
    let locked = Array.from(listItems).filter(el =&gt; el.querySelector(&#39;.locked&#39;));

    // Clear the parent container
    parent.innerHTML = &#39;&#39;;

    // Append unlocked elements first, then locked elements
    unlocked.forEach(el =&gt; parent.appendChild(el));
    locked.forEach(el =&gt; parent.appendChild(el));
});
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="16" name="Make everyone pastries" tags="" position="500,600" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Lannan.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
The pastries are a hit

While Douglas is distracted you implement the fossil fuel exclusion policy
# [[It works!|Good End]]</tw-passagedata><tw-passagedata pid="17" name="Mention economic benefits" tags="success" position="450,150" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Coins.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
&lt;&lt;type 20ms none&gt;&gt;\
You demonstrate to Chairman Sir Douglas Flint how your assets will become stuck in fossil fuels

...as the world moves on to renewables
# [[It works!|Good End]]
&lt;&lt;/type&gt;&gt;\</tw-passagedata><tw-passagedata pid="18" name="Mention severity of climate crisis" tags="success" position="475,0" size="100,100">&lt;&lt;set $image to &quot;img/Fire.png&quot;&gt;&gt;\
&lt;&lt;type 20ms none&gt;&gt;\
You bring up findings from the IPCC and IEA that shows new fossil fuel projects are incompatible with limiting warming to 1.5c

However, existing reserves could be used in the long transition to renewables...
# [[It works!|Good End]]
&lt;&lt;/type&gt;&gt;\</tw-passagedata><tw-passagedata pid="19" name="Risk" tags="success" position="1000,25" size="100,100">&lt;&lt;type 20ms none&gt;&gt;\
You show Chairman Sir Douglas Flint the company&#39;s climate scenario modelling

Including how it&#39;s to be based on wildly optimistic estimates of how the economy would hold up in a warmer world
# [[It works!|Good End]]
&lt;&lt;/type&gt;&gt;\</tw-passagedata><tw-passagedata pid="20" name="Summon League" tags="success" position="400,300" size="100,100">The League of Asset Managers kidnap the board and convince them to join

Everyone gets a cloak
# [[It works!|Good End]]</tw-passagedata><tw-passagedata pid="21" name="Underworld" tags="ending" position="2400,1000" size="100,100">God sends you to the Asset Manager Underworld.

Apparently the fires burn from fossil fuels $company invested in

The fires are hot.
&lt;&lt;include &quot;CTA&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="22" name="Use profound understanding of nature" tags="success" position="450,450" size="100,100">You take the board on an away day to the woods

...and show them the interconnectedness of the natural world
# [[It works!|Good End]]</tw-passagedata><tw-passagedata pid="23" name="Using phoenix magic" tags="success" position="600,400" size="100,100">You spread your fiery wings and cast a spell of persuasion
# [[It works!|Good End]]</tw-passagedata><tw-passagedata pid="24" name="Bad End" tags="ending" position="125,1425" size="100,100">The moral lesson portal closes behind you

Your relationship with your grandchild is ruined

But for those back in the present day, there&#39;s still hope

Help us get abrdn&#39;s board to beat Asset Manager Quest
&lt;&lt;include &quot;CTA&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="25" name="Remedy acidic soils" tags="ending no-type" position="2875,1725" size="100,100">!GAME OVER!
The soil beneath you loses its &#39;&#39;acidity&#39;&#39;

You grow into a stinging nettle

But for the next CEO, it doens&#39;t have to be this way

Help us get abrdn&#39;s board to beat Asset Manager Quest
&lt;&lt;include &quot;CTA&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="26" name="Sell loss" tags="ending" position="700,1400" size="100,100">$company fires you

You are no longer an asset manager CEO

But perhaps your successor can turn things around…

Help us get abrdn&#39;s board to play Asset Manager Quest
&lt;&lt;include &quot;CTA&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="27" name="Face reckoning by almighty power" tags="" position="2200,1200" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Wings-1.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
&lt;&lt;if $evadeGod == true&gt;&gt;God uses his God magic to return you to his office&lt;&lt;else&gt;&gt;You sit down in a chair in God&#39;s cloudy office&lt;&lt;/if&gt;&gt;

The almighty one is pacing back and forth, furiously stroking their wispy beard

&#39;&#39;Defend your place in heaven&#39;&#39;
# [[Mention company&#39;s tree planting|Unhappy God][$answer to &quot;More trees?&quot;]]
# [[Mention company&#39;s double-sided photo-copying|Unhappy God][$answer to &quot;Double-sided photocopying?&quot;]]</tw-passagedata><tw-passagedata pid="28" name="Fly to the celestial realm" tags="" position="2000,1200" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Wings-1.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
You&#39;re kicking back with the angels in Asset Manager heaven

God calls you into his office to talk about $company&#39;s coal policy.

It seems going to &#39;&#39;heaven&#39;&#39; might have been a clerical error
# [[Give God the slip, go cloud surfing|Face reckoning by almighty power][$evadeGod to true]]
# [[Face reckoning by almighty power][$evadeGod to false]]</tw-passagedata><tw-passagedata pid="29" name="Unhappy God" tags="damange" position="2375,1225" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Wings-1.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
&quot;$answer&quot;

God picks up the phone and starts to dial 666

It&#39;s the devil&#39;s number...
# [[Ask for second chance on earth|Resurrect]]
# [[Accept fate|Underworld]]</tw-passagedata><tw-passagedata pid="30" name="Continue getting arse kicked" tags="" position="700,1200" size="100,100">You return with more violence

They respond with compassion

&quot;What are you so afraid of?&quot;
# [[I&#39;m afraid of success|Disciples respond]]
# [[I&#39;m afraid to be loved|Disciples respond]]
# [[I&#39;m afraid of your weird Asset Management cult|Disciples respond]]</tw-passagedata><tw-passagedata pid="31" name="Escape to basement" tags="mystery" position="700,800" size="100,100">The Ghost of Asset Management Future taps you on the shoulder and startles you

&quot;Why are you running?&quot;
# [[I&#39;m afraid of success|Ghost responds]]
# [[I&#39;m afraid to be loved|Ghost responds]]
# [[I&#39;m afraid of ghosts|Ghost responds]]</tw-passagedata><tw-passagedata pid="32" name="Get kidnapped" tags="damange" position="1250,800" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/League.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
&lt;&lt;type 20ms none&gt;&gt;\
People jump out the &#39;&#39;mysterious van&#39;&#39; and bag you

You wake up in a &#39;&#39;candlelit&#39;&#39; room, surrounded by cloaked figures.

&quot;Welcome... to the League of Asset Managers&quot; they chant in unison
# [[The who?|League Short]]
# [[Let me go! I&#39;ve got financial assets to manage|League Short]]
&lt;&lt;/type&gt;&gt;\</tw-passagedata><tw-passagedata pid="33" name="Ghost responds" tags="" position="600,1000" size="100,100">The ghost manager nods understandingly 

&quot;It&#39;s good you can be honest with yourself&quot;

&quot;But you must know the consequences of your choices&quot;

The ghost opens a &#39;&#39;moral lesson portal&#39;&#39;
# [[Enter portal, receive moral lesson|Vision of Future]]
# [[Skip lesson, join league|Join League]]</tw-passagedata><tw-passagedata pid="34" name="Join League" tags="item" position="400,800" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/League.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
!!LEAGUE OF ASSET MANAGERS UNLOCKED!

The league hands you a cloak adorned with their crest

&quot;It&#39;s super comfy. I wear mine to bed&quot; &lt;&lt;set $league to true&gt;&gt;
# [[Question cloak&#39;s appropriateness|Question cloak]]
# [[Implement fossil fuel exclusion policy|Fossil Fuel Policy][$league to true]]</tw-passagedata><tw-passagedata pid="35" name="Karate fail" tags="damange" position="750,1025" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Karate.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
Pow, pow

The black belt Asset Managers floor you with their martial prowess

You wish you&#39;d worn a more loose fitting suit
# [[Escape to basement]]
# [[Continue getting arse kicked]]
# [[Surrender and join the League|Join League]]</tw-passagedata><tw-passagedata pid="36" name="League Short" tags="" position="1025,950" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/League.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
&quot;&#39;&#39;The League&#39;&#39; is a secret society of asset managers…

…who use their assets for good, not for evil&quot;

&quot;We think you have great potential…&quot;
# [[Join league, stop funding fossil fuels|Join League]]
# [[Untie wrist restraints, throw candle|Untie wrist restraints]]</tw-passagedata><tw-passagedata pid="37" name="Question cloak" tags="noreturn" position="325,500" size="100,100">The League gives you a silent, cold stare

Pressure is mounting in the room
# [[Implement fossil fuel exclusion policy|Fossil Fuel Policy][$invincible to true]]</tw-passagedata><tw-passagedata pid="38" name="Sorry Kid" tags="" position="225,1150" size="100,100">&quot;Oh, ok...&quot;

Your grandchild leaves the room to play with his new water desalination device
# [[Return to reality, join League|Join League]]
# [[Stay in horrible future, end game|Bad End]]</tw-passagedata><tw-passagedata pid="39" name="Untie wrist restraints" tags="damange" position="900,775" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Fire.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
&lt;&lt;type 20ms none&gt;&gt;\
The candle causes &#39;&#39;fire&#39;&#39; and &#39;&#39;commotion&#39;&#39;, letting you escape into the hall.

Blocking the exit are &#39;&#39;black belt disciples&#39;&#39; of the League of Asset Managers
&lt;&lt;/type&gt;&gt;\
# [[Karate kick|Karate fail]]
# [[Karate punch|Karate fail]]
# [[Escape to basement]]</tw-passagedata><tw-passagedata pid="40" name="Vision of Future" tags="mystery" position="400,1200" size="100,100">It&#39;s Christmas eve, thirty years in the future. Large parts of the globe are currently uninhabitable

You&#39;re about to sing a Mariah Carey song, but your grandchild interrupts

&quot;You did everything you could to stop the climate crisis... didn&#39;t you Grandad?&quot;
# [[Return to reality, join League|Join League]]
# [[Tell grandchild you invested in fossil fuel expansion in line with your company&#39;s risk assessments|Sorry Kid]]</tw-passagedata><tw-passagedata pid="41" name="Who" tags="noreturn" position="200,600" size="100,100">You enter combat with the game&#39;s creators, who go by the name &#39;&#39;Serious People&#39;&#39;
# &lt;a href=&quot;https://olifro.st&quot;&gt;Punch Oli Frost&lt;br&gt;(Words, Web, Music)&lt;/a&gt;
# &lt;a href=&quot;https://www.mandrews.studio&quot;&gt;Kick Mike Andrews&lt;br&gt;(Design)&lt;/a&gt;
# &lt;a href=&quot;https://www.linkedin.com/in/ruth-newton-86549873/&quot;&gt;Tackle Ruth Newton&lt;br&gt;(Producer)&lt;/a&gt;
# &lt;a href=&quot;https://www.linkedin.com/in/jamieinman/&quot;&gt;Throw Jamie Inman&lt;br&gt;(Campaign Director)&lt;/a&gt;
# &lt;a href=&quot;https://www.linkedin.com/in/thomjames/&quot;&gt;Wrestle Thom James&lt;br&gt;(Digital Strategy)&lt;/a&gt;
&lt;&lt;if $alive&gt;&gt;&lt;&lt;link &quot;Return to game&quot; $return&gt;&gt;&lt;&lt;/link&gt;&gt;&lt;&lt;else&gt;&gt;[[Restart game|Intro][state.restart()]]&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="42" name="abrdn" tags="info noreturn" position="175,725" size="100,100">!A True Story &lt;span class=&quot;nobr&quot;&gt;of Asset&lt;/span&gt; Mismanagement
&#39;&#39;abrdn&#39;&#39; is a real (poorly named) company that is investing over $3.6 billions in bonds issued by fossil fuel expansionists.

It&#39;s one of the few European asset managers that still hasn’t published a coal exclusion policy, and is overall the 4th most exposed asset manager to fossil fuel bonds.

Nice stats! But what&#39;s that mean?

For life on earth, it&#39;s a problem. Research shows that new fossil fuel developments are incompatible with keeping warming &lt;span class=&quot;nobr&quot;&gt;under 1.5c.&lt;/span&gt;

For business it&#39;s not good either – it&#39;s exposing abrdn to both financial and &lt;span class=&quot;nobr&quot;&gt;legal risk.&lt;/span&gt;

As the world moves on to renewables, abrdn&#39;s assets could become stranded in fossil fuels.

But following a disastrous rebrand, company layoffs, and falling stocks, the new CEO has an opportunity to turn their fortunes around.

If you can do it, they can too...
&lt;&lt;if $alive&gt;&gt;\
# &lt;&lt;link &quot;Return to game&quot; $return&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;\
#[[Restart game|Intro][state.restart()]]
&lt;&lt;/if&gt;&gt;\
Learn more about the &lt;a class=&quot;nobr&quot; href=&quot;https://toxicbonds.org&quot;&gt;Toxic Bonds Network&lt;/a&gt;</tw-passagedata><tw-passagedata pid="43" name="Accuse media bullies of bullying" tags="down" position="900,1400" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Approval-down-2.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
The media bullies bully you over your bullying accusation

Staff morale drops to &#39;&#39;&lt;&lt;print $approval&gt;&gt;%&#39;&#39;

&lt;&lt;approval&gt;&gt;
Your &#39;&#39;kids&#39;&#39; ask if you can pick them up from school a couple of streets from the gate, to avoid them &#39;&#39;embarrassment&#39;&#39;
# [[Do another rebrand]]
# [[Implement Casual Fridays|It&#39;s time for casual Fridays]]
# [[Implement fossil fuel exclusion policy|Fossil Fuel Policy][$invincible to true]]</tw-passagedata><tw-passagedata pid="44" name="Fire workforce" tags="down" position="1600,1200" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Approval-down-1.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
Staff morale drops to &#39;&#39;&lt;&lt;print $approval&gt;&gt;%&#39;&#39;

&lt;&lt;approval&gt;&gt;
Your secretary starts getting your &#39;&#39;lunch order&#39;&#39; wrong, quite likely on purpose

Drastic action is needed to get your &#39;&#39;sandwiches&#39;&#39; back on track
# [[It&#39;s time for a rebrand|Rebrand]]
# [[It&#39;s time for casual Fridays]]
# [[It&#39;s time to sell all of abrdn’s coal, oil and gas bonds|Fossil Fuel Policy][$invincible to true]]</tw-passagedata><tw-passagedata pid="45" name="Get job back" tags="" position="1750,775" size="100,200">&lt;&lt;type 20ms none&gt;&gt;\
The share price of $company has fallen fast due to stranded assets in fossil fuels

You aggressively buy shares and take back control
&lt;&lt;if $pastry&gt;&gt;\

Using your pastry profits...
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if not hasVisited(&quot;Give Bonus&quot;)&gt;&gt;\
# [[Divest from the fossil fuel industry|Fossil Fuel Policy][$invincible to true]]
# [[Give yourself a massive bonus|Give Bonus][$approval to 12]]
# [[Make lots of staff redundant|Fire workforce]]
&lt;&lt;else&gt;&gt;\
# [[Divest from the fossil fuel industry|Fossil Fuel Policy][$invincible to true]]
# [[Get back to firing workforce|Fire workforce][$approval to 12]]
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/type&gt;&gt;\</tw-passagedata><tw-passagedata pid="46" name="Give Bonus" tags="down" position="1675,1025" size="200,100">£800,000 is deposited in your account, and staff morale drops to &#39;&#39;&lt;&lt;print $approval&gt;&gt;%&#39;&#39;

&lt;&lt;approval&gt;&gt;
Staff stop looping you into funny email threads.

However, the sun&#39;s out and it seems like a great day to...
# [[Go clothes shopping|Go shopping]]
# [[Go chair shopping|Chair shopping]]
# [[Think about the impacts fossil fuel bonds have on all our futures|Fossil Fuel Policy][$invincible to true]]</tw-passagedata><tw-passagedata pid="47" name="Go back to the office" tags="" position="1575,800" size="100,200">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Office.png&quot;&gt;&gt;
&lt;&lt;set $approval to 12&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
Back in your office you find a moment&#39;s peace surveying Edinburgh&#39;s skyline

You ponder a brighter future at $company

A way to change its reputation... a way to start a conversation...
# [[Make loads of redundancies|Fire workforce]]
# [[Give yourself a massive bonus|Give Bonus]]
# [[Divest from fossil fuel industry|Fossil Fuel Policy][$invincible to true]]</tw-passagedata><tw-passagedata pid="48" name="Go home to get changed" tags="down" position="1025,1700" size="100,100">!!SHORTS REMOVED!

You return to the office, fully trousered&lt;&lt;set $shorts to false&gt;&gt;

But now everyone has gone to the pub

Without you...

Staff morale drops to &#39;&#39;&lt;&lt;print $approval&gt;&gt;%&#39;&#39;

&lt;&lt;approval&gt;&gt;
# [[It&#39;s time for a rebrand|Rebrand]]
# [[It&#39;s time to sell all of our coal, oil and gas bonds|Fossil Fuel Policy][$invincible to true]]</tw-passagedata><tw-passagedata pid="49" name="It&#39;s time for casual Fridays" tags="item" position="1175,1550" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/shorts-tie-shirt-2.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
!!SHORTS UNLOCKED!

&lt;&lt;set $shorts to true&gt;&gt;On the first &#39;&#39;Casual Friday&#39;&#39; you wear shorts

It&#39;s clearly not short weather, and everybody laughs at you
# [[Wear shorts with confidence]]
# [[Go home to get changed]]
# [[Implement a policy against fossil fuels|Fossil Fuel Policy][$invincible to true]]</tw-passagedata><tw-passagedata pid="50" name="Rebrand fail" tags="down" position="1225,1300" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Approval-down-2.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
The &#39;&#39;&lt;&lt;print $company&gt;&gt;&#39;&#39; rebrand does not go well

Staff morale drops to &#39;&#39;&lt;&lt;print $approval&gt;&gt;%&#39;&#39;

&lt;&lt;approval&gt;&gt;
The &#39;&#39;media bullies&#39;&#39; have started making satirical cartoons &lt;span class=&quot;nb&quot;&gt;about you&lt;/span&gt;
# [[Accuse media bullies of bullying]]
# [[Give yourself a massive bonus|Give Bonus]]
# [[Implement fossil fuel exclusion policy|Fossil Fuel Policy][$invincible to true]]
&lt;&lt;script&gt;&gt;gtag(&#39;event&#39;, &#39;rename&#39;, {
  &#39;event_category&#39;: &#39;abrdn&#39;,
  &#39;event_label&#39;: State.variables.company
});&lt;&lt;/script&gt;&gt;\</tw-passagedata><tw-passagedata pid="51" name="Show them your shorts" tags="" position="700,575" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/shorts-tie-shirt-2.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
You put your leg up on the chair, confidently displaying your casual shorts

While Chairman Sir Douglas Flint is distracted by your legs, you implement the fossil fuel exclusion policy

# [[It works!|Good End]]</tw-passagedata><tw-passagedata pid="52" name="Sigh, with regret" tags="noreturn mystery" position="600,1600" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Stranded-Assets.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
Years pass and your assets in fossil fuels have become stranded as the market moves on to renewables

&#39;&#39;Abrdn&#39;&#39; is nicknamed &#39;&#39;Abrdoomed&#39;&#39;
# [[Sell fossil fuel bonds at huge loss|Sell loss]]</tw-passagedata><tw-passagedata pid="53" name="Start selling staff&#39;s computers" tags="down" position="1225,1900" size="100,100">You sell off the staff&#39;s Bloomberg terminals

The new computers are slow, and staff morale drops to &#39;&#39;&lt;&lt;print $approval&gt;&gt;%&#39;&#39;

Whenever you approach the water cooler, staff abruptly leave with half full glasses.

&lt;&lt;approval&gt;&gt;
&lt;&lt;if not hasVisited(&quot;Fire workforce&quot;)&gt;&gt;\
# [[Make loads of people redundant|Fire workforce]]
# [[Buy yourself a big chair|Chair shopping]]
# [[Deny debt to coal, oil and gas companies|Fossil Fuel Policy]]
&lt;&lt;else&gt;&gt;\
# [[Give yourself a massive bonus|Give Bonus]]
# [[Buy yourself a big chair|Chair shopping]]
# [[Deny debt to coal, oil and gas companies|Fossil Fuel Policy]]
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="54" name="Stay in office" tags="" position="1450,800" size="100,200">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Office.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
You&#39;re about to beat your &#39;&#39;high score&#39;&#39; when &#39;&#39;Tracy Hahn&#39;&#39; from HR interrupts

Staff morale is at &#39;&#39;&lt;&lt;print $approval&gt;&gt;%&#39;&#39;

&lt;&lt;approval&gt;&gt;
&#39;&#39;But maybe you can fix that...&#39;&#39;
# [[Make loads of redundancies|Fire workforce]]
# [[Give yourself a massive bonus|Give Bonus]]
# [[Divest from fossil fuel industry|Fossil Fuel Policy][$invincible to true]]</tw-passagedata><tw-passagedata pid="55" name="Tea bags" tags="down" position="1250,1700" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Approval-down-2.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
Staff have to keep little mason jars on their desks with their own tea bags

It saves around £180.33 per year, but staff morale drops to &#39;&#39;&lt;&lt;print $approval&gt;&gt;%&#39;&#39;

&lt;&lt;approval&gt;&gt;
&lt;&lt;if not hasVisited(&quot;Fire workforce&quot;)&gt;&gt;\
# [[Make loads of people redundant|Fire workforce]]
# [[Start selling staff&#39;s computers]]
# [[Deny debt to coal, oil and gas companies|Fossil Fuel Policy]]
&lt;&lt;else&gt;&gt;\
# [[Give yourself a massive bonus|Give Bonus]]
# [[Start selling staff&#39;s computers]]
# [[Deny debt to coal, oil and gas companies|Fossil Fuel Policy]]
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="56" name="Wear shorts with confidence" tags="down" position="1400,1700" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/shorts-tie-shirt-sad.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
It doesn&#39;t work.

Staff morale drops to &#39;&#39;&lt;&lt;print $approval&gt;&gt;%&#39;&#39;

&lt;&lt;approval&gt;&gt;
People continue laughing at your legs
# [[Make staff pay for their own tea bags|Tea bags]]
# [[Sell coal, oil and gas bonds|Fossil Fuel Policy][$invincible to true]]</tw-passagedata><tw-passagedata pid="57" name="You Died" tags="nope" position="750,1725" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Approval-down-3.png&quot;&gt;&gt;
&lt;&lt;set $alive to false&gt;&gt;&lt;&lt;set $approval to 1&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
&#39;&#39;Staff morale&#39;&#39; is too low

Chairman Sir Douglas Flint pulls you into his office

He wants to know your vision for abrdn
&lt;&lt;if $nature&gt;&gt;\
# [[Stop investing in fossil fuels|Fossil Fuel Policy][$invincible to true]]
# [[Keep investing in fossil fuels|Sigh, with regret]]
&lt;&lt;else&gt;&gt;\
# [[Stop investing in fossil fuels|Fossil Fuel Policy][$invincible to true]]
# [[Keep investing in fossil fuels|Sigh, with regret]]
# [[Quit job, go live in forest|Life after office]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="58" name="Become a pastry chef" tags="item" position="1925,675" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Pastry-chef.png&quot;&gt;&gt;
&lt;&lt;set $pastry to true&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
!!PASTRY TALENT UNLOCKED

Three years pass...

You now make croissants full time, which is lovely

But besides rebranding the bakery Lannan as Lnnnn... 

You haven&#39;t done much&lt;&lt;set $pastry to true&gt;&gt;
# [[Go get your job back|Get job back]]
# [[Put your passion into pastry|Passion into pastry]]</tw-passagedata><tw-passagedata pid="59" name="Discuss pastry" tags="nope" position="3000,850" size="100,100">&lt;&lt;set $image to &quot;img/Bird therapist.png&quot;&gt;&gt;\
&lt;&lt;type 20ms none&gt;&gt;\
Was $pastry really the right choice?

Perhaps it wasn&#39;t ambitious enough

The bird offers no answers or help
&lt;&lt;if not hasVisited(&quot;Discuss storm&quot;)&gt;&gt;\
# [[Discuss annoying storm|Discuss storm]]
# [[Discuss climate crisis]]
&lt;&lt;else&gt;&gt;\
# [[Discuss climate crisis]]
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/type&gt;&gt;\</tw-passagedata><tw-passagedata pid="60" name="Discuss storm" tags="nope" position="3025,675" size="100,100">&lt;&lt;set $image to &quot;img/Bird therapist.png&quot;&gt;&gt;\
&lt;&lt;type 20ms none&gt;&gt;\
You blame your defeat on the gale-force winds, making no mention of the climate crisis that made them more likely

The bird offers no answers or help
&lt;&lt;if not hasVisited(&quot;Discuss pastry&quot;)&gt;&gt;\
# [[Discuss choice of pastry|Discuss pastry]]
# [[Discuss climate crisis]]
&lt;&lt;else&gt;&gt;\
# [[Discuss climate crisis]]
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/type&gt;&gt;\</tw-passagedata><tw-passagedata pid="61" name="Get pastries" tags="secondlevel" position="1350,500" size="100,200">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Lannan.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
&lt;&lt;type 20ms none&gt;&gt;\
Yeah, who needs penguins anyway.

You pass a &#39;&#39;mysterious van&#39;&#39; on your way to the Lannan bakery

As you finish your flaky &#39;&#39;croissant&#39;&#39;, your partner calls

One of your children just learned how bad the climate crisis is and is &#39;&#39;crying&#39;&#39;
# [[Go home to crying child]]
# [[Go get more pastries|Go back for more pastries]]
# [[Go check mysterious van|Get kidnapped]]
&lt;&lt;/type&gt;&gt;</tw-passagedata><tw-passagedata pid="62" name="Go back for more pastries" tags="nope" position="1625,575" size="100,100">The hipster pastry shop lady raises her eyebrow inquisitively

&quot;Another pastry? I&#39;m afraid we&#39;re sold out.&quot;

&quot;The instability of gas prices has made us more conservative in how often we use the croissant oven&quot;
# [[Stop investing in coal, oil and gas|Fossil Fuel Policy]]
# [[Stop asking for pastries|Go back to the office]]
# [[Become a pastry chef]]</tw-passagedata><tw-passagedata pid="63" name="Passion into pastry" tags="" position="2100,800" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Pastry-chef.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
&lt;&lt;set _name to &quot;&quot;, $pastry to &quot;Cinnamon Swirl&quot;&gt;&gt;\
&lt;&lt;type 20ms none&gt;&gt;\
After years of training, you reach the final of the World Pastry Championships

You&#39;re up against your bitter rival Larry, another ex-asset manager

&#39;&#39;What will you bake?&#39;&#39;

&lt;&lt;textbox &quot;_name&quot; $pastry&gt;&gt;
# &lt;&lt;link &quot;Choose Pastry&quot;&gt;&gt;&lt;&lt;set _name to _name.trim()&gt;&gt;&lt;&lt;set $pastry to _name&gt;&gt;&lt;&lt;goto &quot;Pastry Championships&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
# [[Switch to Apple Strudel|Pastry Championships][$pastry to &quot;Apple Strudel&quot;]]
# [[Switch to Baklava|Pastry Championships][$pastry to &quot;Baklava&quot;]]
&lt;&lt;/type&gt;&gt;\</tw-passagedata><tw-passagedata pid="64" name="Pastry Championships" tags="" position="2225,1000" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Pastry-chef.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
&lt;&lt;type 20ms none&gt;&gt;\
The contest is interrupted by gale-force winds

Your $pastry is blown out of your hands

The skies of Edinburgh are filled with baked goods

Maybe the pastry business wasn&#39;t for you...
# [[Go get your job back|Get job back]]
# [[Go live in nature|Life after pastry]]
&lt;&lt;/type&gt;&gt;\</tw-passagedata><tw-passagedata pid="65" name="Quick End" tags="win noreturn" position="1175,150" size="200,200">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/YOU WIN.png&quot;&gt;&gt;
&lt;&lt;set $notherapy to true&gt;&gt;\
&lt;&lt;/silently&gt;&gt;\
&lt;&lt;type 15ms none&gt;&gt;\
Your fellow asset managers sing songs about you, praising &lt;span class=&quot;nobr&quot;&gt;your leadership&lt;/span&gt;

&#39;&#39;$company&#39;&#39; gets its reputation back on track with a &#39;&#39;policy to stop investing in coal, oil and gas bonds&#39;&#39;

While the world transitions to cleaner, cheaper, safer &lt;span class=&quot;nobr&quot;&gt;renewable energy&lt;/span&gt;

Too easy? &lt;&lt;link &quot;Start again&quot; $return&gt;&gt;&lt;&lt;/link&gt;&gt; and make a different choice
# &lt;&lt;link &quot;Restart game&quot; $return&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/type&gt;&gt;\</tw-passagedata><tw-passagedata pid="66" name="Intro" tags="no-type intro" position="1025,550" size="200,200">&lt;&lt;silently&gt;&gt;\
&lt;&lt;setvariables&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
&lt;&lt;type 20ms start 2s none&gt;&gt;\
You are the new CEO of &#39;&#39;$company&#39;&#39; asset management

Your company is stuck in the past, putting billions into fossil fuels

One day, a &#39;&#39;thought&#39;&#39; arrives

&quot;Maybe we should... &lt;br class=&quot;optional-br&quot;&gt;not do that?&quot;
# [[Ignore thought, go get pastries|Get pastries]]
# [[Ignore thought, play minesweeper|Stay in office]]
# [[Listen to thought, stop funding fossil fuels|Quick End]]
&lt;&lt;/type&gt;&gt;\</tw-passagedata><tw-passagedata pid="67" name="Attack the hate" tags="mystery" position="1550,1825" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Sad Manager.png&quot;&gt;&gt;
&lt;&lt;set $notherapy to true&gt;&gt;\
&lt;&lt;/silently&gt;&gt;\
The hate dodges. 

Emotional capacity at &#39;&#39;250%&#39;&#39;

You collapse due to too many emotions.
# [[Go live in nature|Go to live in nature]]
# [[Go clubbing]]</tw-passagedata><tw-passagedata pid="68" name="Buy yourself a big chair" tags="" position="1350,2000" size="100,100">Staff morale drops to &#39;&#39;&lt;&lt;print $approval&gt;&gt;%

&lt;&lt;approval&gt;&gt;

The chair is comfy, but you&#39;re uncomfortable

You feel sad somehow
# [[Explore the sadness|Explore the sadness]]
# [[Push the sadness down]]</tw-passagedata><tw-passagedata pid="69" name="Chair room" tags="" position="2050,1350" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Stephen-chair.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
The $clothes is comfy, but you&#39;re uncomfortable

You feel sad somehow
# [[Explore the sadness|Explore the sadness]]
# [[Push the sadness down]]</tw-passagedata><tw-passagedata pid="70" name="Chair shopping" tags="" position="1925,1100" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Stephen-chair.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
You arrive in a stylish, office chair showroom

The choice is overwhelming

But you feel empowered by possibilities of having lots of money
# [[Sit on big leather chair|Chair room][$clothes to &quot;big leather chair&quot;]]
# [[Sit on big ergonomic chair|Chair room][$clothes to &quot;big ergonomic chair&quot;]]
# [[Sit on humble chair|Chair room][$clothes to &quot;humble chair&quot;]]</tw-passagedata><tw-passagedata pid="71" name="Dressing Room" tags="" position="1500,1525" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Sad Manager.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
In the changing room mirror, you like what you see

The $clothes is a perfect fit for your supple asset managing body

But in your eyes, there&#39;s a sadness
# [[Explore the sadness|Explore the sadness]]
# [[Push the sadness down]]</tw-passagedata><tw-passagedata pid="72" name="Explore the sadness" tags="rework" position="1900,1550" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Sad Manager.png&quot;&gt;&gt;
&lt;&lt;set $notherapy to true&gt;&gt;\
&lt;&lt;/silently&gt;&gt;\
You care for the future of life on earth...

But fund the destruction of it...

The emotion becomes &#39;&#39;too much&#39;&#39;
# [[Go to live in nature|Spend more time in forest]]</tw-passagedata><tw-passagedata pid="73" name="Go clubbing" tags="forest" position="1825,1900" size="100,100">&lt;&lt;set $notherapy to true&gt;&gt;\
&lt;span class=&quot;drunk&quot;&gt;
It&#39;s 3AM when you finally leave the sticky dance floor at &#39;&#39;Gari&#39;s&#39;&#39;

A wise owl, that maybe isn&#39;t real, perches on a bollard.

You feel like opening up to it&lt;/span&gt;
# [[Discuss childhood]]
# [[Discuss what you bought in the mall|Discuss clothes]]
# [[Discuss climate crisis]]</tw-passagedata><tw-passagedata pid="74" name="Go shopping" tags="" position="1725,1275" size="100,100">&lt;&lt;type 20ms none&gt;&gt;\
You arrive at one of Edinburgh&#39;s great shopping malls

Madonna&#39;s &quot;Material Girl&quot; plays on the mall radio

You feel empowered by possibilities of having lots of money
# [[Try on plain white oxford shirts|Dressing Room][$clothes to &quot;white oxford shirt&quot;]]
# [[Try on plain blue oxford shirts|Dressing Room][$clothes to &quot;blue oxford shirt&quot;]]
# [[Try on funky tie|Dressing Room][$clothes to &quot;funky tie&quot;]]
&lt;&lt;/type&gt;&gt;\</tw-passagedata><tw-passagedata pid="75" name="Push anger down" tags="nope" position="2100,1800" size="100,100">The anger leads to hate

The hate turns on you

Emotional capacity at &#39;&#39;125%&#39;&#39;
# [[Attack the hate]]
# [[Explore self-hate|Explore the sadness]]</tw-passagedata><tw-passagedata pid="76" name="Push fear down" tags="nope" position="1725,1725" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Sad Manager.png&quot;&gt;&gt;
&lt;&lt;set $notherapy to true&gt;&gt;\
&lt;&lt;/silently&gt;&gt;\
The fear leads to panic

It gets more panicky

Emotional capacity at &#39;&#39;75%&#39;&#39;
# [[Push panic down]]
# [[Explore emotions|Explore the sadness]]</tw-passagedata><tw-passagedata pid="77" name="Push panic down" tags="nope" position="1900,1750" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Sad Manager.png&quot;&gt;&gt;
&lt;&lt;set $notherapy to true&gt;&gt;\
&lt;&lt;/silently&gt;&gt;\
The panic leads to anger.

It gets more angry.

Emotional capacity at &#39;&#39;95%&#39;&#39;
# [[Push anger down]]
# [[Explore emotions|Explore the sadness]]</tw-passagedata><tw-passagedata pid="78" name="Push the sadness down more" tags="nope" position="1700,1500" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Sad Manager.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
The sadness turns into objectless fear

It gets more fearful.

Emotional capacity at &#39;&#39;50%&#39;&#39;
# [[Push fear down]]
# [[Explore the fear|Explore the sadness]]</tw-passagedata><tw-passagedata pid="79" name="Push the sadness down" tags="nope" position="1875,1375" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Sad Manager.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
The sadness doesn&#39;t want to be pushed down

It gets more sad

Emotional capacity at &#39;&#39;40%&#39;&#39;
# [[Keep trying to push sadness down|Push the sadness down more]]
# [[Explore the sadness]]</tw-passagedata><tw-passagedata pid="80" name="Disciples respond" tags="" position="500,1400" size="100,100">&quot;It&#39;s good you can be honest with yourself&quot;

&quot;But you must understand the consequences of the choices you&#39;re making&quot;

The disciples open a &#39;&#39;moral lesson portal&#39;&#39;
# [[Enter portal, receive moral lesson|Vision of Future]]
# [[Skip lesson, join league|Join League]]</tw-passagedata><tw-passagedata pid="81" name="Discuss childhood" tags="rework nope" position="2900,1175" size="100,100">&lt;&lt;set $image to &quot;img/Bird therapist.png&quot;&gt;&gt;\
You recall a day the playground bullies laughed, and you cried

The day you wore socks with the days of the week written on them

The bird offers no answers or help
&lt;&lt;if not hasVisited(&quot;Discuss clothes&quot;)&gt;&gt;\
# [[Discuss your mall purchases|Discuss clothes]]
# [[Discuss climate crisis]]
&lt;&lt;else&gt;&gt;\
# [[Discuss climate crisis]]
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="82" name="Discuss climate crisis" tags="" position="3075,1375" size="100,100">&lt;&lt;cacheaudio &quot;bird&quot; &quot;sound/bird-1.mp3&quot;&gt;&gt;\
&lt;&lt;audio &quot;bird&quot; play volume 0.2&gt;&gt;\
&lt;&lt;set $image to &quot;img/Bird therapist.png&quot;&gt;&gt;\
You care about the future of the planet

Yet you funded the destruction of it

The disparity between belief and action dawns on you

The &#39;&#39;bird&#39;&#39; chirps appreciatively
# [[Learn more from nature|Spend more time in forest]]
# [[Go get your job back|Get job back]]</tw-passagedata><tw-passagedata pid="83" name="Discuss clothes" tags="nope" position="2700,1250" size="100,100">&lt;&lt;set $image to &quot;img/Bird therapist.png&quot;&gt;&gt;\
You explore your emotional connection to the $clothes

The bird offers no answers or help
&lt;&lt;if not hasVisited(&quot;Discuss childhood&quot;)&gt;&gt;\
# [[Discuss your childhood|Discuss childhood]]
# [[Discuss climate crisis]]
&lt;&lt;else&gt;&gt;\
# [[Discuss climate crisis]]
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="84" name="Discuss media bullying" tags="" position="750,2000" size="100,100">You complain about the media bullying you

The bird points out you bully the planet every day

Fair enough…
&lt;&lt;if not hasVisited(&quot;Discuss staff bullying&quot;)&gt;&gt;\
# [[Discuss staff bullying]]
# [[Discuss climate crisis]]
&lt;&lt;else&gt;&gt;\
# [[Discuss climate crisis]]
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="85" name="Discuss staff bullying" tags="" position="875,2000" size="100,100">You complain about your staff bullying you

The bird points out you bully the planet every day

Fair enough…
&lt;&lt;if not hasVisited(&quot;Discuss media bullying&quot;)&gt;&gt;\
# [[Discuss media bullying]]
# [[Discuss climate crisis]]
&lt;&lt;else&gt;&gt;\
# [[Discuss climate crisis]]
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="86" name="Emerge from the flames" tags="item" position="2500,1600" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Phoenix.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
&lt;&lt;type 20ms none&gt;&gt;\
You are reborn, not as an asset manager

But as a magical phoenix asset manager

You go flying and stuff &lt;&lt;set $phoenix to true&gt;&gt;

!!PHOENIX MAGIC UNLOCKED!
# [[Confront company about fossil fuel policy|Fossil Fuel Policy][$invincible to true]]
&lt;&lt;/type&gt;&gt;\</tw-passagedata><tw-passagedata pid="87" name="Go to live in nature" tags="rework forest" position="2850,975" size="100,100">&lt;&lt;set $image to &quot;img/Bird therapist.png&quot;&gt;&gt;\
&lt;&lt;type 20ms none&gt;&gt;\
It&#39;s another day out in the Scottish forest

You discuss your emotions with your therapist...

…who happens to a bird
# [[Discuss childhood]]
# [[Discuss recent purchases|Discuss clothes]]
# [[Discuss climate crisis]]
&lt;&lt;/type&gt;&gt;\</tw-passagedata><tw-passagedata pid="88" name="Life after office" tags="forest" position="750,1875" size="100,100">&lt;&lt;set $image to &quot;img/Bird therapist.png&quot;&gt;&gt;\
&lt;&lt;type 20ms none&gt;&gt;\
It&#39;s another day out in the Scottish forest

You discuss your failed asset managing career with your therapist

…who happens to be a bird
# [[Discuss media bullying]]
# [[Discuss staff bullying]]
# [[Discuss climate crisis]]
&lt;&lt;/type&gt;&gt;\</tw-passagedata><tw-passagedata pid="89" name="Life after pastry" tags="forest" position="2775,825" size="100,100">&lt;&lt;set $image to &quot;img/Bird therapist.png&quot;&gt;&gt;\
&lt;&lt;type 20ms none&gt;&gt;\
It&#39;s another day out in the Scottish forest

You discuss your defeat in the Pastry Championships with your therapist

…who happens to be a bird
# [[Discuss your choice of pastry|Discuss pastry]]
# [[Discuss annoying storm|Discuss storm]]
# [[Discuss climate crisis]]
&lt;&lt;/type&gt;&gt;\</tw-passagedata><tw-passagedata pid="90" name="Spend more time in forest" tags="item" position="2275,1425" size="100,100">&lt;&lt;set $image to &quot;img/trees.png&quot;&gt;&gt;\
&lt;&lt;type 20ms none&gt;&gt;\
&lt;&lt;if $notherapy&gt;&gt;\
You go to live in the Scottish forest, and come to see the natural world differently
&lt;&lt;else&gt;&gt;\
In the years that pass out in the forest, you come to see the natural world differently
&lt;&lt;/if&gt;&gt;\

Instead of an asset to be traded

You see yourself as part of it

!!Understanding of natural world unlocked!&lt;&lt;set $nature to true&gt;&gt;
# [[Go get your job back|Get job back]]
# [[Keep living in forest]]
&lt;&lt;/type&gt;&gt;\</tw-passagedata><tw-passagedata pid="91" name="Fail Music" tags="" position="2350,100" size="100,100"></tw-passagedata><tw-passagedata pid="92" name="Learn" tags="" position="2775,600" size="100,100">Nothing to see here

&lt;&lt;return&gt;&gt;</tw-passagedata><tw-passagedata pid="93" name="Passage List" tags="poof.ignore no-type" position="2625,350" size="100,100">&lt;&lt;for _p range Story.lookupWith(p =&gt; p)&gt;&gt;
  &lt;&lt;link _p.title _p.title&gt;&gt;&lt;&lt;/link&gt;&gt;
&lt;&lt;/for&gt;&gt;</tw-passagedata><tw-passagedata pid="94" name="PassageDone" tags="poof.ignore" position="2650,75" size="100,100"></tw-passagedata><tw-passagedata pid="95" name="PassageFooter" tags="Header poof.ignore no-type" position="25,975" size="100,100">&lt;&lt;if _tags.includes(&quot;ending&quot;)&gt;&gt;\
[[Restart game|Intro][state.restart()]]
&lt;&lt;/if&gt;&gt;\</tw-passagedata><tw-passagedata pid="96" name="PassageHeader" tags="poof.ignore no-type" position="2550,175" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set _tags to tags()&gt;&gt;
&lt;&lt;if _tags.includes(&quot;ending&quot;)&gt;&gt;
    &lt;&lt;set $alive to false&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
&lt;&lt;if _tags.includes(&quot;ending&quot;)&gt;&gt;\
    &lt;&lt;set $alive to false&gt;&gt;\
    &lt;&lt;set $image to &quot;img/GAME OVER 2.png&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;if _tags.includes(&quot;down&quot;)&gt;&gt;\
&lt;&lt;set $approval to $approval - 3&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;silently&gt;&gt;\
&lt;&lt;if _tags.includes(&quot;ending&quot;)&gt;&gt;
    &lt;&lt;cacheaudio &quot;fail&quot; &quot;sound/fail.mp3&quot;&gt;&gt;\
    &lt;&lt;audio &quot;:playing:not(:ui)&quot; fadeoverto 1 0&gt;&gt;
    &lt;&lt;audio &quot;fail&quot; play&gt;&gt;\
&lt;&lt;elseif _tags.includes(&quot;intro&quot;)&gt;&gt;
    &lt;&lt;audio &quot;load&quot; play volume 0.2&gt;&gt;
&lt;&lt;elseif _tags.includes(&quot;win&quot;)&gt;&gt;
    &lt;&lt;audio &quot;win&quot; play volume 0.2&gt;&gt;
&lt;&lt;elseif _tags.includes(&quot;item&quot;)&gt;&gt;
    &lt;&lt;audio &quot;win&quot; play&gt;&gt;
&lt;&lt;elseif _tags.includes(&quot;beep&quot;)&gt;&gt;
    &lt;&lt;audio &quot;select&quot; play&gt;&gt;
&lt;&lt;elseif _tags.includes(&quot;owl&quot;)&gt;&gt;
    &lt;&lt;cacheaudio &quot;owl&quot; &quot;sound/owl.wav&quot;&gt;&gt;
    &lt;&lt;audio &quot;owl&quot; play volume 0.2&gt;&gt;
&lt;&lt;elseif _tags.includes(&quot;mystery&quot;)&gt;&gt;
    &lt;&lt;audio &quot;mystery&quot; play&gt;&gt;
&lt;&lt;elseif _tags.includes(&quot;forest&quot;)&gt;&gt;
&lt;&lt;cacheaudio &quot;forest&quot; &quot;sound/forest.mp3&quot;&gt;&gt;
    &lt;&lt;audio &quot;forest&quot; play&gt;&gt;
&lt;&lt;elseif _tags.includes(&quot;damange&quot;)&gt;&gt;
    &lt;&lt;audio &quot;explode&quot; play&gt;&gt;
&lt;&lt;elseif _tags.includes(&quot;danger&quot;)&gt;&gt;
    &lt;&lt;audio &quot;danger&quot; play&gt;&gt;
&lt;&lt;elseif _tags.includes(&quot;down&quot;)&gt;&gt;
    &lt;&lt;if $approval === 0&gt;&gt;
          &lt;&lt;audio &quot;danger&quot; play&gt;&gt;
    &lt;&lt;else&gt;&gt;
        &lt;&lt;audio &quot;down&quot; play&gt;&gt;
    &lt;&lt;/if&gt;&gt;
&lt;&lt;elseif _tags.includes(&quot;nope&quot;)&gt;&gt;
    &lt;&lt;audio &quot;nope&quot; play&gt;&gt;
&lt;&lt;elseif _tags.includes(&quot;success&quot;)&gt;&gt;
    &lt;&lt;audio &quot;load&quot; play&gt;&gt;
&lt;&lt;else&gt;&gt;
    &lt;&lt;if $alternateSound is undefined or $alternateSound is &quot;select&quot;&gt;&gt;
        &lt;&lt;set $alternateSound to &quot;ping&quot;&gt;&gt;
        &lt;&lt;audio &quot;ping&quot; play&gt;&gt;
    &lt;&lt;else&gt;&gt;
        &lt;&lt;set $alternateSound to &quot;select&quot;&gt;&gt;
        &lt;&lt;audio &quot;select&quot; play&gt;&gt;
    &lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
&lt;&lt;script&gt;&gt;gtag(&#39;event&#39;, &#39;loaded&#39;, {
  &#39;event_category&#39;: &#39;passage&#39;,
  &#39;event_label&#39;: State.variables.passage_name
});&lt;&lt;/script&gt;&gt;\</tw-passagedata><tw-passagedata pid="97" name="PassageReady" tags="poof.ignore no-type" position="2550,75" size="100,100">&lt;&lt;set _tags to tags()&gt;&gt;
&lt;&lt;set $image to &quot;img/Asset Manager.png&quot;&gt;&gt;\</tw-passagedata><tw-passagedata pid="98" name="Snippets" tags="" position="2825,225" size="100,100">&lt;&lt;if $alternateSound is undefined or $alternateSound is &quot;select&quot;&gt;&gt;
        &lt;&lt;set $alternateSound to &quot;ping&quot;&gt;&gt;
        &lt;&lt;audio &quot;ping&quot; play&gt;&gt;
    &lt;&lt;else&gt;&gt;
        &lt;&lt;set $alternateSound to &quot;select&quot;&gt;&gt;
        &lt;&lt;audio &quot;select&quot; play&gt;&gt;
    &lt;&lt;/if&gt;&gt;
    
     &lt;div id=&quot;gamestate&quot; class=&quot;animate__animated animate__jackInTheBox&quot;&gt;[img[img/WIN.png]]&lt;/div&gt;
     
             &lt;div id=&quot;gameover&quot; class=&quot;animate__animated animate__jackInTheBox&quot;&gt;[img[img/GAME OVER 2.png]]&lt;/div&gt;
             
             
             

&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;

&lt;/head&gt;</tw-passagedata><tw-passagedata pid="99" name="StoryCaption" tags="no-type poof.ignore" position="75,175" size="100,100"></tw-passagedata><tw-passagedata pid="100" name="StoryDisplayTitle" tags="no-type poof.ignore" position="175,175" size="100,100">Asset Manager Quest</tw-passagedata><tw-passagedata pid="101" name="StoryInit" tags="utility" position="2450,75" size="100,100">&lt;&lt;cacheaudio &quot;load&quot; &quot;sound/load.mp3&quot;&gt;&gt;
&lt;&lt;setvariables&gt;&gt;
&lt;&lt;set $image to &quot;img/Asset Manager.png&quot;&gt;&gt;

&lt;&lt;cacheaudio &quot;ping&quot; &quot;sound/Ping1.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;select&quot; &quot;sound/Ping2.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;win&quot; &quot;sound/win.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;down&quot; &quot;sound/down.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;mystery&quot; &quot;sound/mystery.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;explode&quot; &quot;sound/explode.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;danger&quot; &quot;sound/danger.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;nope&quot; &quot;sound/nope.mp3&quot;&gt;&gt;
&lt;&lt;createaudiogroup &quot;:ui&quot;&gt;&gt;
	&lt;&lt;track &quot;select&quot;&gt;&gt;
	&lt;&lt;track &quot;win&quot;&gt;&gt;
  	&lt;&lt;track &quot;load&quot;&gt;&gt;
     &lt;&lt;track &quot;ping&quot;&gt;&gt;
      &lt;&lt;track &quot;down&quot;&gt;&gt;
      &lt;&lt;track &quot;mystery&quot;&gt;&gt;
      &lt;&lt;track &quot;explode&quot;&gt;&gt;
      &lt;&lt;track &quot;danger&quot;&gt;&gt;
      &lt;&lt;track &quot;nope&quot;&gt;&gt;
&lt;&lt;/createaudiogroup&gt;&gt;
&lt;&lt;audio &quot;:all:ui&quot; volume 0.40&gt;&gt;</tw-passagedata><tw-passagedata pid="102" name="StoryInterface" tags="" position="275,25" size="100,100">&lt;body&gt;
&lt;div id=&quot;splash-screen&quot;&gt;&lt;span id=&quot;splash-logo&quot;&gt;&lt;img class=&quot;animate__animated animate__fadeInUp&quot; src=&quot;img/AMQ-Rev.png&quot;&gt;&lt;p class=&quot;animate__animated animate__fadeInUp animate__delay-1s&quot;&gt;Loading assets...&lt;/p&gt;&lt;/span&gt;&lt;/div&gt;
    &lt;div class=&quot;game-container&quot; id=&quot;protectedContent&quot; class=&quot;hidden&quot;&gt;
        &lt;div class=&quot;header&quot;&gt;
            &lt;div id=&quot;sidePanel&quot; data-passage=&quot;sidePanel&quot; class=&quot;menu&quot;&gt;&lt;/div&gt;
            &lt;div id=&quot;banner&quot;&gt;
                 &lt;div id=&quot;banner-left&quot;&gt;&lt;img src=&quot;img/banner-left.png&quot;&gt;&lt;/div&gt;
           		 &lt;div id=&quot;banner-logo&quot; data-passage=&quot;theimage&quot; class=&quot;floating animate__animated animate__fadeInUp&quot;&gt;&lt;/div&gt;
             	 &lt;div id=&quot;banner-right&quot;&gt;&lt;img src=&quot;img/banner-right.png&quot;&gt;&lt;/div&gt;             
  		  &lt;/div&gt;
        &lt;/div&gt;      
        &lt;div class=&quot;game-content&quot;&gt;
            &lt;div id=&quot;passages&quot;&gt;&lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;!-- Google tag (gtag.js) --&gt;
&lt;script async src=&quot;https://www.googletagmanager.com/gtag/js?id=G-YJK5VPRCDE&quot;&gt;&lt;/script&gt;
&lt;script&gt;
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag(&#39;js&#39;, new Date());

  gtag(&#39;config&#39;, &#39;G-YJK5VPRCDE&#39;);
&lt;/script&gt;
&lt;/body&gt;</tw-passagedata><tw-passagedata pid="103" name="StoryShare" tags="poof.ignore" position="175,275" size="100,100">[[LinkedIn|https://linkedin.com/]]</tw-passagedata><tw-passagedata pid="104" name="StorySubtitle" tags="no-type poof.ignore" position="75,0" size="100,100">The game where you get to be a financial asset manager</tw-passagedata><tw-passagedata pid="105" name="TypeTemplate" tags="poof.ignore" position="2725,350" size="100,100">&lt;&lt;type &quot;&quot;&gt;&gt;
&lt;&lt;display&gt;&gt;</tw-passagedata><tw-passagedata pid="106" name="no-type" tags="" position="75,75" size="100,100"></tw-passagedata><tw-passagedata pid="107" name="sidePanel" tags="no-type" position="2625,450" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;div class=&quot;logo-bar&quot;&gt;
&lt;div  id=&quot;small-logo&quot; &gt;&lt;img src=&quot;img/AMQ-Logo-Long-White-Fill.png&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;menu-options&quot;&gt;
 [img[Restart|img/restart-w.svg][Intro][state.restart()]]
    &lt;a data-passage=&quot;abrdn&quot;&gt;
             &lt;svg version=&quot;1.1&quot; id=&quot;Layer_1&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; x=&quot;0px&quot; y=&quot;0px&quot;
         viewBox=&quot;0 0 1200 1200&quot; style=&quot;enable-background:new 0 0 1200 1200;&quot; xml:space=&quot;preserve&quot;&gt;
    &lt;g&gt;
        &lt;path d=&quot;M637.3,525.1H787v149.8H637.3L637.3,525.1z&quot;/&gt;
        &lt;path d=&quot;M487.5,525.1h149.8v149.8H487.5V525.1z&quot;/&gt;
        &lt;path d=&quot;M487.5,674.9h149.8v149.8H487.5V674.9z&quot;/&gt;
        &lt;path d=&quot;M190.6,225.6h149.8v149.8H190.6L190.6,225.6z&quot;/&gt;
        &lt;path d=&quot;M340.3,75.9h149.8v149.8H340.3L340.3,75.9z&quot;/&gt;
        &lt;path d=&quot;M487.5,75.9h149.8v149.8H487.5V75.9z&quot;/&gt;
        &lt;path d=&quot;M637.3,75.9H787v149.8H637.3L637.3,75.9z&quot;/&gt;
        &lt;path d=&quot;M787,225.6h149.8v149.8H787V225.6z&quot;/&gt;
        &lt;path d=&quot;M787,375.4h149.8v149.8H787V375.4z&quot;/&gt;
        &lt;path d=&quot;M487.5,974.4h149.8v149.8H487.5V974.4z&quot;/&gt;
    &lt;/g&gt;
    &lt;/svg&gt;
&lt;/a&gt;
&lt;&lt;link [img[img/music.svg]]&gt;&gt;
	&lt;&lt;PlayTrack start_bgm&gt;&gt;
&lt;&lt;/link&gt;&gt;

	[[CREDITS|Who]]
&lt;/div&gt;

&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="108" name="theimage" tags="utility" position="2675,200" size="100,100">[img[$image]]</tw-passagedata><tw-passagedata pid="109" name="Widgets" tags="widget nobr no-type" position="2425,300" size="100,100">&lt;&lt;widget &quot;approval&quot;&gt;&gt;
&lt;&lt;run Health($approval, $maxapproval, &quot;horizontalhealthbar&quot;, true)&gt;&gt;
&lt;div id=&quot;horizontalhealthbarbkg&quot; class=&quot;hzbarbkg&quot;&gt;
&lt;div id=&quot;horizontalhealthbar&quot; class=&quot;hzbar&quot;  style=&quot;width: 100%;&quot;&gt;&lt;/div&gt;&lt;/div&gt;
&lt;&lt;script&gt;&gt;$(document).one(&#39;:passagerender&#39;, function (ev) {
	Health(State.variables.approval, State.variables.maxapproval, &quot;horizontalhealthbar&quot;, true, ev.content);
});&lt;&lt;/script&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;PlayTrack&quot;&gt;&gt;
    &lt;&lt;set _trackList = {  /* Add your track IDs and filenames below. */
        &quot;start_bgm&quot; : &quot;track1.mp3&quot;
    }&gt;&gt;
    &lt;&lt;set _nextTrack = $args.raw&gt;&gt;
    &lt;&lt;if def _trackList[_nextTrack]&gt;&gt;
        &lt;&lt;if !TrackExists(_nextTrack)&gt;&gt;  /* If track doesn&#39;t exist, load it. */
            &lt;&lt;set _bgm = setup.SoundPath + _trackList[_nextTrack]&gt;&gt;
            &lt;&lt;cacheaudio _nextTrack _bgm&gt;&gt;
        &lt;&lt;/if&gt;&gt;
        &lt;&lt;if !TrackExists(_nextTrack)&gt;&gt;
            &lt;&lt;run alert(&#39;Error: Cannot load file &quot;&#39; + setup.SoundPath + _trackList[_nextTrack] + &#39;&quot;.&#39;)&gt;&gt;
        &lt;&lt;else&gt;&gt;
            &lt;&lt;if isPlaying(_nextTrack)&gt;&gt;  /* If track is already playing, stop it. */
                &lt;&lt;masteraudio stop&gt;&gt;
            &lt;&lt;else&gt;&gt;  /* If track is not playing, play it. */
                &lt;&lt;masteraudio stop&gt;&gt;
                &lt;&lt;set _bgm = setup.SoundPath + &quot;track1.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;start_bgm&quot; _bgm&gt;&gt;
                &lt;&lt;audio _nextTrack loop volume 0 fadein&gt;&gt;
            &lt;&lt;/if&gt;&gt;
        &lt;&lt;/if&gt;&gt;
    &lt;&lt;else&gt;&gt;
        &lt;&lt;run alert(&#39;Error: Unknown track &quot;&#39; + _nextTrack + &#39;&quot;.&#39;)&gt;&gt;
    &lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;setvariables&quot;&gt;&gt;
&lt;&lt;set $league to false&gt;&gt;
&lt;&lt;set $alive to true&gt;&gt;
&lt;&lt;set $nature to false&gt;&gt;
&lt;&lt;set $god to false&gt;&gt;
&lt;&lt;set $child to false&gt;&gt;
&lt;&lt;set $phoenix to false&gt;&gt;
&lt;&lt;set $pastry to false&gt;&gt;
&lt;&lt;set $shorts to false&gt;&gt;
&lt;&lt;set $notherapy to false&gt;&gt;
&lt;&lt;set $undead to false&gt;&gt;
&lt;&lt;set $company to &quot;abrdn&quot;&gt;&gt;
&lt;&lt;set $approval to 12&gt;&gt;
&lt;&lt;set $maxapproval to 100&gt;&gt;
&lt;&lt;set $invincible to false&gt;&gt;
&lt;&lt;set $gameLoaded to false&gt;&gt;
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="110" name="nobr" tags="poof.ignore" position="175,0" size="100,100"></tw-passagedata><tw-passagedata pid="111" name="CTA" tags="" position="250,1550" size="100,100">#  &lt;a href=&quot;https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.linkedin.com/shareArticle?mini=true&amp;url=assetmanager.quest&quot; &gt;Share on LinkedIn (and tag abrdn)&lt;/a&gt;
# &lt;a href=&quot;mailto:?subject=Asset Manager Quest&amp;body=Found this great game where you get to be an Asset Manager assetmanager.quest&quot;&gt;Share link in email&lt;/a&gt;
# [[Learn more about abrdn&#39;s toxic bonds|abrdn]]</tw-passagedata><tw-passagedata pid="112" name="Good End" tags="win" position="1175,150" size="200,200">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/YOU WIN.png&quot;&gt;&gt;
&lt;&lt;set $notherapy to true&gt;&gt;\
&lt;&lt;/silently&gt;&gt;\
&lt;&lt;type 20ms none&gt;&gt;\
Your fellow asset managers sing songs about you, praising &lt;span class=&quot;nobr&quot;&gt;your leadership&lt;/span&gt;

&#39;&#39;$company&#39;&#39; gets its reputation back on track with a &#39;&#39;policy to stop investing in coal, oil and gas bonds&#39;&#39;

…while the world transitions to cleaner, cheaper, safer &lt;span class=&quot;nobr&quot;&gt;renewable energy&lt;/span&gt;
&lt;&lt;if $undead &gt;&gt;
Staff are happy to help you deal with the undead horse too...
&lt;&lt;/if&gt;&gt;\

Too easy? [[Start again|Intro]] and make a different choice

Or help us get abrdn&#39;s board to beat the game too
&lt;&lt;include &quot;CTA&quot;&gt;&gt;
&lt;&lt;/type&gt;&gt;\</tw-passagedata><tw-passagedata pid="113" name="Buy child pony" tags="" position="1700,400" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Pony.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
&lt;&lt;set _name to &quot;&quot;, $pony to &quot;Sparkle&quot;&gt;&gt;\
What should we call the &#39;&#39;pony&#39;&#39;?

&lt;&lt;textbox &quot;_name&quot; $pony&gt;&gt;
# &lt;&lt;link &quot;Choose Name&quot;&gt;&gt;&lt;&lt;set _name to _name.trim()&gt;&gt;&lt;&lt;set $pony to _name&gt;&gt;&lt;&lt;goto &quot;Named Pony&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="114" name="Do another rebrand" tags="" position="900,1575" size="100,100">&lt;&lt;set _name to &quot;&quot;, $company to &quot;ABBAdn&quot;&gt;&gt;\
What should we rebrand as?

&lt;&lt;textbox &quot;_name&quot; $company&gt;&gt;
# &lt;&lt;link &quot;Choose Name&quot;&gt;&gt;&lt;&lt;set _name to _name.trim()&gt;&gt;&lt;&lt;set $company to _name&gt;&gt;&lt;&lt;goto &quot;Rebrand fail&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;</tw-passagedata><tw-passagedata pid="115" name="Rebrand" tags="" position="1000,1200" size="100,100">&lt;&lt;silently&gt;&gt;\
&lt;&lt;set $image to &quot;img/Office.png&quot;&gt;&gt;
&lt;&lt;/silently&gt;&gt;\
The branding agency who took you from &#39;&#39;Aberdeen&#39;&#39; to &#39;&#39;&lt;&lt;print $company&gt;&gt;&#39;&#39; suggests &#39;&#39;removing more vowels&#39;&#39; from your name

This did not go well the last time

What should we rebrand as?

&lt;&lt;textbox &quot;_name&quot; &quot;Brdn&quot;&gt;&gt;
# &lt;&lt;link &quot;Choose Name&quot;&gt;&gt;&lt;&lt;set _name to _name.trim()&gt;&gt;&lt;&lt;set $company to _name&gt;&gt;&lt;&lt;goto &quot;Rebrand fail&quot;&gt;&gt;&lt;&lt;/link&gt;&gt;
# [[Could we be  ‘Abrgreen’?|Fossil Fuel Policy][$company to &quot;Abrgreen&quot;]]</tw-passagedata></tw-storydata>

<script>(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var saveAs=saveAs||function(e){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var t=e.document,n=function(){return e.URL||e.webkitURL||e},o=t.createElementNS("http://www.w3.org/1999/xhtml","a"),r="download"in o,i=function(e){var t=new MouseEvent("click");e.dispatchEvent(t)},a=/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),c=e.webkitRequestFileSystem,s=e.requestFileSystem||c||e.mozRequestFileSystem,d=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},f=0,u=function(e){var t=function(){"string"==typeof e?n().revokeObjectURL(e):e.remove()};setTimeout(t,4e4)},l=function(e,t,n){t=[].concat(t);for(var o=t.length;o--;){var r=e["on"+t[o]];if("function"==typeof r)try{r.call(e,n||e)}catch(e){d(e)}}},p=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["ï»¿",e],{type:e.type}):e},v=function(t,d,v){v||(t=p(t));var w,y,m,S=this,h=t.type,R=!1,O=function(){l(S,"writestart progress write writeend".split(" "))},g=function(){if(y&&a&&"undefined"!=typeof FileReader){var o=new FileReader;return o.onloadend=function(){var e=o.result;y.location.href="data:attachment/file"+e.slice(e.search(/[,;]/)),S.readyState=S.DONE,O()},o.readAsDataURL(t),void(S.readyState=S.INIT)}if(!R&&w||(w=n().createObjectURL(t)),y)y.location.href=w;else{void 0===e.open(w,"_blank")&&a&&(e.location.href=w)}S.readyState=S.DONE,O(),u(w)},b=function(e){return function(){if(S.readyState!==S.DONE)return e.apply(this,arguments)}},E={create:!0,exclusive:!1};return S.readyState=S.INIT,d||(d="download"),r?(w=n().createObjectURL(t),void setTimeout(function(){o.href=w,o.download=d,i(o),O(),u(w),S.readyState=S.DONE})):(e.chrome&&h&&"application/octet-stream"!==h&&(m=t.slice||t.webkitSlice,t=m.call(t,0,t.size,"application/octet-stream"),R=!0),c&&"download"!==d&&(d+=".download"),("application/octet-stream"===h||c)&&(y=e),s?(f+=t.size,void s(e.TEMPORARY,f,b(function(e){e.root.getDirectory("saved",E,b(function(e){var n=function(){e.getFile(d,E,b(function(e){e.createWriter(b(function(n){n.onwriteend=function(t){y.location.href=e.toURL(),S.readyState=S.DONE,l(S,"writeend",t),u(e)},n.onerror=function(){var e=n.error;e.code!==e.ABORT_ERR&&g()},"writestart progress write abort".split(" ").forEach(function(e){n["on"+e]=S["on"+e]}),n.write(t),S.abort=function(){n.abort(),S.readyState=S.DONE},S.readyState=S.WRITING}),g)}),g)};e.getFile(d,{create:!1},b(function(e){e.remove(),n()}),b(function(e){e.code===e.NOT_FOUND_ERR?n():g()}))}),g)}),g)):void g())},w=v.prototype,y=function(e,t,n){return new v(e,t,n)};return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return n||(e=p(e)),navigator.msSaveOrOpenBlob(e,t||"download")}:(w.abort=function(){var e=this;e.readyState=e.DONE,l(e,"abort")},w.readyState=w.INIT=0,w.WRITING=1,w.DONE=2,w.error=w.onwritestart=w.onprogress=w.onwrite=w.onabort=w.onerror=w.onwriteend=null,y)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof module&&module.exports?module.exports.saveAs=saveAs:"undefined"!=typeof define&&null!==define&&null!==define.amd&&define([],function(){return saveAs});

},{}],2:[function(require,module,exports){
!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define("underscore",r):function(){var t=n._,e=r();n._=e,e.noConflict=function(){return n._=t,e}}()}(this,function(){function n(r){return r instanceof n?r:this instanceof n?void(this._wrapped=r):new n(r)}function r(n,r,t){if(void 0===r)return n;switch(null==t?3:t){case 1:return function(t){return n.call(r,t)};case 3:return function(t,e,u){return n.call(r,t,e,u)};case 4:return function(t,e,u,o){return n.call(r,t,e,u,o)}}return function(){return n.apply(r,arguments)}}function t(n,t,e){return null==n?In:Pr(n)?r(n,t,e):Sn(n)&&!Wr(n)?qn(n):Rn(n)}function e(n,r){return t(n,r,1/0)}function u(r,u,o){return n.iteratee!==e?n.iteratee(r,u):t(r,u,o)}function o(n,r){return r=null==r?n.length-1:+r,function(){for(var t=Math.max(arguments.length-r,0),e=Array(t),u=0;u<t;u++)e[u]=arguments[u+r];switch(r){case 0:return n.call(this,e);case 1:return n.call(this,arguments[0],e);case 2:return n.call(this,arguments[0],arguments[1],e)}var o=Array(r+1);for(u=0;u<r;u++)o[u]=arguments[u];return o[r]=e,n.apply(this,o)}}function i(n){if(!Sn(n))return{};if(tr)return tr(n);or.prototype=n;var r=new or;return or.prototype=null,r}function a(n){return function(r){return null==r?void 0:r[n]}}function f(n,r){return null!=n&&Zn.call(n,r)}function c(n,r){for(var t=r.length,e=0;e<t;e++){if(null==n)return;n=n[r[e]]}return t?n:void 0}function l(n){var r=fr(n);return"number"==typeof r&&r>=0&&r<=ar}function p(n,t,e){t=r(t,e);var u,o;if(l(n))for(u=0,o=n.length;u<o;u++)t(n[u],u,n);else{var i=en(n);for(u=0,o=i.length;u<o;u++)t(n[i[u]],i[u],n)}return n}function s(n,r,t){r=u(r,t);for(var e=!l(n)&&en(n),o=(e||n).length,i=Array(o),a=0;a<o;a++){var f=e?e[a]:a;i[a]=r(n[f],f,n)}return i}function h(n){var t=function(r,t,e,u){var o=!l(r)&&en(r),i=(o||r).length,a=n>0?0:i-1;for(u||(e=r[o?o[a]:a],a+=n);a>=0&&a<i;a+=n){var f=o?o[a]:a;e=t(e,r[f],f,r)}return e};return function(n,e,u,o){var i=arguments.length>=3;return t(n,r(e,o,4),u,i)}}function v(n,r,t){var e=l(n)?_r:sn,u=e(n,r,t);if(void 0!==u&&-1!==u)return n[u]}function y(n,r,t){var e=[];return r=u(r,t),p(n,function(n,t,u){r(n,t,u)&&e.push(n)}),e}function g(n,r,t){return y(n,Y(u(r)),t)}function d(n,r,t){r=u(r,t);for(var e=!l(n)&&en(n),o=(e||n).length,i=0;i<o;i++){var a=e?e[i]:i;if(!r(n[a],a,n))return!1}return!0}function m(n,r,t){r=u(r,t);for(var e=!l(n)&&en(n),o=(e||n).length,i=0;i<o;i++){var a=e?e[i]:i;if(r(n[a],a,n))return!0}return!1}function b(n,r,t,e){return l(n)||(n=on(n)),("number"!=typeof t||e)&&(t=0),xr(n,r,t)>=0}function j(n,r){return s(n,Rn(r))}function _(n,r){return y(n,qn(r))}function w(n,r){return v(n,qn(r))}function x(n,r,t){var e,o,i=-1/0,a=-1/0;if(null==r||"number"==typeof r&&"object"!=typeof n[0]&&null!=n){n=l(n)?n:on(n);for(var f=0,c=n.length;f<c;f++)null!=(e=n[f])&&e>i&&(i=e)}else r=u(r,t),p(n,function(n,t,e){((o=r(n,t,e))>a||o===-1/0&&i===-1/0)&&(i=n,a=o)});return i}function S(n,r,t){var e,o,i=1/0,a=1/0;if(null==r||"number"==typeof r&&"object"!=typeof n[0]&&null!=n){n=l(n)?n:on(n);for(var f=0,c=n.length;f<c;f++)null!=(e=n[f])&&e<i&&(i=e)}else r=u(r,t),p(n,function(n,t,e){((o=r(n,t,e))<a||o===1/0&&i===1/0)&&(i=n,a=o)});return i}function A(n){return O(n,1/0)}function O(n,r,t){if(null==r||t)return l(n)||(n=on(n)),n[Wn(n.length-1)];var e=l(n)?yn(n):on(n),u=fr(e);r=Math.max(Math.min(r,u),0);for(var o=u-1,i=0;i<r;i++){var a=Wn(i,o),f=e[i];e[i]=e[a],e[a]=f}return e.slice(0,r)}function M(n,r,t){var e=0;return r=u(r,t),j(s(n,function(n,t,u){return{value:n,index:e++,criteria:r(n,t,u)}}).sort(function(n,r){var t=n.criteria,e=r.criteria;if(t!==e){if(t>e||void 0===t)return 1;if(t<e||void 0===e)return-1}return n.index-r.index}),"value")}function E(n,r){return function(t,e,o){var i=r?[[],[]]:{};return e=u(e,o),p(t,function(r,u){var o=e(r,u,t);n(i,r,o)}),i}}function N(n){return n?Wr(n)?Xn.call(n):Kr(n)?n.match(yr):l(n)?s(n,In):on(n):[]}function k(n){return null==n?0:l(n)?n.length:en(n).length}function I(n,r,t){return null==n||n.length<1?null==r?void 0:[]:null==r||t?n[0]:T(n,n.length-r)}function T(n,r,t){return Xn.call(n,0,Math.max(0,n.length-(null==r||t?1:r)))}function B(n,r,t){return null==n||n.length<1?null==r?void 0:[]:null==r||t?n[n.length-1]:R(n,Math.max(0,n.length-r))}function R(n,r,t){return Xn.call(n,null==r||t?1:r)}function F(n){return y(n,Boolean)}function q(n,r,t,e){e=e||[];for(var u=e.length,o=0,i=fr(n);o<i;o++){var a=n[o];if(l(a)&&(Wr(a)||zr(a)))if(r)for(var f=0,c=a.length;f<c;)e[u++]=a[f++];else q(a,r,t,e),u=e.length;else t||(e[u++]=a)}return e}function D(n,r){return q(n,r,!1)}function W(n,r,t,e){Mn(r)||(e=t,t=r,r=!1),null!=t&&(t=u(t,e));for(var o=[],i=[],a=0,f=fr(n);a<f;a++){var c=n[a],l=t?t(c,a,n):c;r&&!t?(a&&i===l||o.push(c),i=l):t?b(i,l)||(i.push(l),o.push(c)):b(o,c)||o.push(c)}return o}function z(n){for(var r=[],t=arguments.length,e=0,u=fr(n);e<u;e++){var o=n[e];if(!b(r,o)){var i;for(i=1;i<t&&b(arguments[i],o);i++);i===t&&r.push(o)}}return r}function P(n){for(var r=n&&x(n,fr).length||0,t=Array(r),e=0;e<r;e++)t[e]=j(n,e);return t}function K(n,r){for(var t={},e=0,u=fr(n);e<u;e++)r?t[n[e]]=r[e]:t[n[e][0]]=n[e][1];return t}function L(n){return function(r,t,e){t=u(t,e);for(var o=fr(r),i=n>0?0:o-1;i>=0&&i<o;i+=n)if(t(r[i],i,r))return i;return-1}}function V(n,r,t,e){t=u(t,e,1);for(var o=t(r),i=0,a=fr(n);i<a;){var f=Math.floor((i+a)/2);t(n[f])<o?i=f+1:a=f}return i}function C(n,r,t){return function(e,u,o){var i=0,a=fr(e);if("number"==typeof o)n>0?i=o>=0?o:Math.max(o+a,i):a=o>=0?Math.min(o+1,a):o+a+1;else if(t&&o&&a)return o=t(e,u),e[o]===u?o:-1;if(u!==u)return o=r(Xn.call(e,i,a),On),o>=0?o+i:-1;for(o=n>0?i:a-1;o>=0&&o<a;o+=n)if(e[o]===u)return o;return-1}}function J(n,r,t){null==r&&(r=n||0,n=0),t||(t=r<n?-1:1);for(var e=Math.max(Math.ceil((r-n)/t),0),u=Array(e),o=0;o<e;o++,n+=t)u[o]=n;return u}function U(n,r){if(null==r||r<1)return[];for(var t=[],e=0,u=n.length;e<u;)t.push(Xn.call(n,e,e+=r));return t}function $(n,r,t,e,u){if(!(e instanceof r))return n.apply(t,u);var o=i(n.prototype),a=n.apply(o,u);return Sn(a)?a:o}function G(n,r){var t=function(e){var u=t.cache,o=""+(r?r.apply(this,arguments):e);return f(u,o)||(u[o]=n.apply(this,arguments)),u[o]};return t.cache={},t}function H(n,r,t){var e,u,o,i,a=0;t||(t={});var f=function(){a=!1===t.leading?0:Yr(),e=null,i=n.apply(u,o),e||(u=o=null)},c=function(){var c=Yr();a||!1!==t.leading||(a=c);var l=r-(c-a);return u=this,o=arguments,l<=0||l>r?(e&&(clearTimeout(e),e=null),a=c,i=n.apply(u,o),e||(u=o=null)):e||!1===t.trailing||(e=setTimeout(f,l)),i};return c.cancel=function(){clearTimeout(e),a=0,e=u=o=null},c}function Q(n,r,t){var e,u,i=function(r,t){e=null,t&&(u=n.apply(r,t))},a=o(function(o){if(e&&clearTimeout(e),t){var a=!e;e=setTimeout(i,r),a&&(u=n.apply(this,o))}else e=Er(i,r,this,o);return u});return a.cancel=function(){clearTimeout(e),e=null},a}function X(n,r){return Or(r,n)}function Y(n){return function(){return!n.apply(this,arguments)}}function Z(){var n=arguments,r=n.length-1;return function(){for(var t=r,e=n[r].apply(this,arguments);t--;)e=n[t].call(this,e);return e}}function nn(n,r){return function(){if(--n<1)return r.apply(this,arguments)}}function rn(n,r){var t;return function(){return--n>0&&(t=r.apply(this,arguments)),n<=1&&(r=null),t}}function tn(n,r){var t=Tr.length,e=n.constructor,u=Pr(e)&&e.prototype||Gn,o="constructor";for(f(n,o)&&!b(r,o)&&r.push(o);t--;)(o=Tr[t])in n&&n[o]!==u[o]&&!b(r,o)&&r.push(o)}function en(n){if(!Sn(n))return[];if(rr)return rr(n);var r=[];for(var t in n)f(n,t)&&r.push(t);return Ir&&tn(n,r),r}function un(n){if(!Sn(n))return[];var r=[];for(var t in n)r.push(t);return Ir&&tn(n,r),r}function on(n){for(var r=en(n),t=r.length,e=Array(t),u=0;u<t;u++)e[u]=n[r[u]];return e}function an(n,r,t){r=u(r,t);for(var e=en(n),o=e.length,i={},a=0;a<o;a++){var f=e[a];i[f]=r(n[f],f,n)}return i}function fn(n){for(var r=en(n),t=r.length,e=Array(t),u=0;u<t;u++)e[u]=[r[u],n[r[u]]];return e}function cn(n){for(var r={},t=en(n),e=0,u=t.length;e<u;e++)r[n[t[e]]]=t[e];return r}function ln(n){var r=[];for(var t in n)Pr(n[t])&&r.push(t);return r.sort()}function pn(n,r){return function(t){var e=arguments.length;if(r&&(t=Object(t)),e<2||null==t)return t;for(var u=1;u<e;u++)for(var o=arguments[u],i=n(o),a=i.length,f=0;f<a;f++){var c=i[f];r&&void 0!==t[c]||(t[c]=o[c])}return t}}function sn(n,r,t){r=u(r,t);for(var e,o=en(n),i=0,a=o.length;i<a;i++)if(e=o[i],r(n[e],e,n))return e}function hn(n,r,t){return r in t}function vn(n,r){var t=i(n);return r&&Rr(t,r),t}function yn(n){return Sn(n)?Wr(n)?n.slice():Br({},n):n}function gn(n,r){return r(n),n}function dn(n,r){var t=en(r),e=t.length;if(null==n)return!e;for(var u=Object(n),o=0;o<e;o++){var i=t[o];if(r[i]!==u[i]||!(i in u))return!1}return!0}function mn(n,r,t,e){if(n===r)return 0!==n||1/n==1/r;if(null==n||null==r)return!1;if(n!==n)return r!==r;var u=typeof n;return("function"===u||"object"===u||"object"==typeof r)&&bn(n,r,t,e)}function bn(r,t,e,u){r instanceof n&&(r=r._wrapped),t instanceof n&&(t=t._wrapped);var o=Yn.call(r);if(o!==Yn.call(t))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+r==""+t;case"[object Number]":return+r!=+r?+t!=+t:0==+r?1/+r==1/t:+r==+t;case"[object Date]":case"[object Boolean]":return+r==+t;case"[object Symbol]":return Hn.valueOf.call(r)===Hn.valueOf.call(t)}var i="[object Array]"===o;if(!i){if("object"!=typeof r||"object"!=typeof t)return!1;var a=r.constructor,c=t.constructor;if(a!==c&&!(Pr(a)&&a instanceof a&&Pr(c)&&c instanceof c)&&"constructor"in r&&"constructor"in t)return!1}e=e||[],u=u||[];for(var l=e.length;l--;)if(e[l]===r)return u[l]===t;if(e.push(r),u.push(t),i){if((l=r.length)!==t.length)return!1;for(;l--;)if(!mn(r[l],t[l],e,u))return!1}else{var p,s=en(r);if(l=s.length,en(t).length!==l)return!1;for(;l--;)if(p=s[l],!f(t,p)||!mn(r[p],t[p],e,u))return!1}return e.pop(),u.pop(),!0}function jn(n,r){return mn(n,r)}function _n(n){return null==n||(l(n)&&(Wr(n)||Kr(n)||zr(n))?0===n.length:0===en(n).length)}function wn(n){return!(!n||1!==n.nodeType)}function xn(n){return function(r){return Yn.call(r)==="[object "+n+"]"}}function Sn(n){var r=typeof n;return"function"===r||"object"===r&&!!n}function An(n){return!Ur(n)&&ur(n)&&!er(parseFloat(n))}function On(n){return Lr(n)&&er(n)}function Mn(n){return!0===n||!1===n||"[object Boolean]"===Yn.call(n)}function En(n){return null===n}function Nn(n){return void 0===n}function kn(n,r){if(!Wr(r))return f(n,r);for(var t=r.length,e=0;e<t;e++){var u=r[e];if(null==n||!Zn.call(n,u))return!1;n=n[u]}return!!t}function In(n){return n}function Tn(n){return function(){return n}}function Bn(){}function Rn(n){return Wr(n)?function(r){return c(r,n)}:a(n)}function Fn(n){return null==n?function(){}:function(r){return Wr(r)?c(n,r):n[r]}}function qn(n){return n=Rr({},n),function(r){return dn(r,n)}}function Dn(n,t,e){var u=Array(Math.max(0,n));t=r(t,e,1);for(var o=0;o<n;o++)u[o]=t(o);return u}function Wn(n,r){return null==r&&(r=n,n=0),n+Math.floor(Math.random()*(r-n+1))}function zn(n){var r=function(r){return n[r]},t="(?:"+en(n).join("|")+")",e=RegExp(t),u=RegExp(t,"g");return function(n){return n=null==n?"":""+n,e.test(n)?n.replace(u,r):n}}function Pn(n,r,t){Wr(r)||(r=[r]);var e=r.length;if(!e)return Pr(t)?t.call(n):t;for(var u=0;u<e;u++){var o=null==n?void 0:n[r[u]];void 0===o&&(o=t,u=e),n=Pr(o)?o.call(n):o}return n}function Kn(n){var r=++et+"";return n?n+r:r}function Ln(r,t,e){!t&&e&&(t=e),t=Dr({},t,n.templateSettings);var u=RegExp([(t.escape||ot).source,(t.interpolate||ot).source,(t.evaluate||ot).source].join("|")+"|$","g"),o=0,i="__p+='";r.replace(u,function(n,t,e,u,a){return i+=r.slice(o,a).replace(at,ft),o=a+n.length,t?i+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'":e?i+="'+\n((__t=("+e+"))==null?'':__t)+\n'":u&&(i+="';\n"+u+"\n__p+='"),n}),i+="';\n",t.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";var a;try{a=new Function(t.variable||"obj","_",i)}catch(n){throw n.source=i,n}var f=function(r){return a.call(this,r,n)};return f.source="function("+(t.variable||"obj")+"){\n"+i+"}",f}function Vn(r){var t=n(r);return t._chain=!0,t}function Cn(r,t){return r._chain?n(t).chain():t}function Jn(r){return p(ln(r),function(t){var e=n[t]=r[t];n.prototype[t]=function(){var r=[this._wrapped];return Qn.apply(r,arguments),Cn(this,e.apply(n,r))}}),n}var Un="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||Function("return this")()||{},$n=Array.prototype,Gn=Object.prototype,Hn="undefined"!=typeof Symbol?Symbol.prototype:null,Qn=$n.push,Xn=$n.slice,Yn=Gn.toString,Zn=Gn.hasOwnProperty,nr=Array.isArray,rr=Object.keys,tr=Object.create,er=Un.isNaN,ur=Un.isFinite,or=function(){},ir=n.VERSION="1.10.2";n.iteratee=e;var ar=Math.pow(2,53)-1,fr=a("length"),cr=h(1),lr=h(-1),pr=o(function(n,r,t){var e,u;return Pr(r)?u=r:Wr(r)&&(e=r.slice(0,-1),r=r[r.length-1]),s(n,function(n){var o=u;if(!o){if(e&&e.length&&(n=c(n,e)),null==n)return;o=n[r]}return null==o?o:o.apply(n,t)})}),sr=E(function(n,r,t){f(n,t)?n[t].push(r):n[t]=[r]}),hr=E(function(n,r,t){n[t]=r}),vr=E(function(n,r,t){f(n,t)?n[t]++:n[t]=1}),yr=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g,gr=E(function(n,r,t){n[t?0:1].push(r)},!0),dr=o(function(n,r){return br(n,r)}),mr=o(function(n){return W(q(n,!0,!0))}),br=o(function(n,r){return r=q(r,!0,!0),y(n,function(n){return!b(r,n)})}),jr=o(P),_r=L(1),wr=L(-1),xr=C(1,_r,V),Sr=C(-1,wr),Ar=o(function(n,r,t){if(!Pr(n))throw new TypeError("Bind must be called on a function");var e=o(function(u){return $(n,e,r,this,t.concat(u))});return e}),Or=o(function(n,r){var t=Or.placeholder,e=function(){for(var u=0,o=r.length,i=Array(o),a=0;a<o;a++)i[a]=r[a]===t?arguments[u++]:r[a];for(;u<arguments.length;)i.push(arguments[u++]);return $(n,e,this,this,i)};return e});Or.placeholder=n;var Mr=o(function(n,r){r=q(r,!1,!1);var t=r.length;if(t<1)throw new Error("bindAll must be passed function names");for(;t--;){var e=r[t];n[e]=Ar(n[e],n)}}),Er=o(function(n,r,t){return setTimeout(function(){return n.apply(null,t)},r)}),Nr=Or(Er,n,1),kr=Or(rn,2),Ir=!{toString:null}.propertyIsEnumerable("toString"),Tr=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],Br=pn(un),Rr=pn(en),Fr=o(function(n,t){var e={},u=t[0];if(null==n)return e;Pr(u)?(t.length>1&&(u=r(u,t[1])),t=un(n)):(u=hn,t=q(t,!1,!1),n=Object(n));for(var o=0,i=t.length;o<i;o++){var a=t[o],f=n[a];u(f,a,n)&&(e[a]=f)}return e}),qr=o(function(n,r){var t,e=r[0];return Pr(e)?(e=Y(e),r.length>1&&(t=r[1])):(r=s(q(r,!1,!1),String),e=function(n,t){return!b(r,t)}),Fr(n,e,t)}),Dr=pn(un,!0),Wr=nr||xn("Array"),zr=xn("Arguments"),Pr=xn("Function"),Kr=xn("String"),Lr=xn("Number"),Vr=xn("Date"),Cr=xn("RegExp"),Jr=xn("Error"),Ur=xn("Symbol"),$r=xn("Map"),Gr=xn("WeakMap"),Hr=xn("Set"),Qr=xn("WeakSet");!function(){zr(arguments)||(zr=function(n){return f(n,"callee")})}();var Xr=Un.document&&Un.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof Xr&&(Pr=function(n){return"function"==typeof n||!1});var Yr=Date.now||function(){return(new Date).getTime()},Zr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},nt=cn(Zr),rt=zn(Zr),tt=zn(nt),et=0,ut=n.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},ot=/(.)^/,it={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},at=/\\|'|\r|\n|\u2028|\u2029/g,ft=function(n){return"\\"+it[n]};p(["pop","push","reverse","shift","sort","splice","unshift"],function(r){var t=$n[r];n.prototype[r]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!==r&&"splice"!==r||0!==n.length||delete n[0],Cn(this,n)}}),p(["concat","join","slice"],function(r){var t=$n[r];n.prototype[r]=function(){return Cn(this,t.apply(this._wrapped,arguments))}}),n.prototype.value=function(){return this._wrapped},n.prototype.valueOf=n.prototype.toJSON=n.prototype.value,n.prototype.toString=function(){return String(this._wrapped)};var ct={default:n,VERSION:ir,iteratee:e,restArguments:o,each:p,forEach:p,map:s,collect:s,reduce:cr,foldl:cr,inject:cr,reduceRight:lr,foldr:lr,find:v,detect:v,filter:y,select:y,reject:g,every:d,all:d,some:m,any:m,contains:b,includes:b,include:b,invoke:pr,pluck:j,where:_,findWhere:w,max:x,min:S,shuffle:A,sample:O,sortBy:M,groupBy:sr,indexBy:hr,countBy:vr,toArray:N,size:k,partition:gr,first:I,head:I,take:I,initial:T,last:B,rest:R,tail:R,drop:R,compact:F,flatten:D,without:dr,uniq:W,unique:W,union:mr,intersection:z,difference:br,unzip:P,zip:jr,object:K,findIndex:_r,findLastIndex:wr,sortedIndex:V,indexOf:xr,lastIndexOf:Sr,range:J,chunk:U,bind:Ar,partial:Or,bindAll:Mr,memoize:G,delay:Er,defer:Nr,throttle:H,debounce:Q,wrap:X,negate:Y,compose:Z,after:nn,before:rn,once:kr,keys:en,allKeys:un,values:on,mapObject:an,pairs:fn,invert:cn,functions:ln,methods:ln,extend:Br,extendOwn:Rr,assign:Rr,findKey:sn,pick:Fr,omit:qr,defaults:Dr,create:vn,clone:yn,tap:gn,isMatch:dn,isEqual:jn,isEmpty:_n,isElement:wn,isArray:Wr,isObject:Sn,isArguments:zr,isFunction:Pr,isString:Kr,isNumber:Lr,isDate:Vr,isRegExp:Cr,isError:Jr,isSymbol:Ur,isMap:$r,isWeakMap:Gr,isSet:Hr,isWeakSet:Qr,isFinite:An,isNaN:On,isBoolean:Mn,isNull:En,isUndefined:Nn,has:kn,identity:In,constant:Tn,noop:Bn,property:Rn,propertyOf:Fn,matcher:qn,matches:qn,times:Dn,random:Wn,now:Yr,escape:rt,unescape:tt,result:Pn,uniqueId:Kn,templateSettings:ut,template:Ln,chain:Vn,mixin:Jn},lt=Jn(ct);return lt._=lt,lt});

},{}],3:[function(require,module,exports){
var filesaver=require("filesaver.js-npm"),_=require("underscore"),dotGraph={};!function(e){var t={checkpoint:!0,checkpointTag:"checkpoint",cluster:!1,clusterTags:[],color:"length",countWords:!0,display:!0,dotExtension:"gv",ends:!0,endTag:"end",engine:"dot",hideDot:!1,hideSettings:!1,increment:.2,lastTag:!1,omitSpecialPassages:!0,omitSpecialTags:!0,omitTags:[],prefix:"",postfix:"",renumber:!1,rotation:"TB",scale:"100%",showNodeNames:!1,snowstick:!1,snowstickObj:{},tooltips:!0,trace:"",palette:["#FEAF16","#2ED9FF","#DEA0FD","#FE00FA","#F7E1A0","#16FF32","#3283FE","#1C8356","#FBE426","#FA0087","#F8A19F","#1CBE4F","#C4451C","#C075A6","#90AD1C","#B00068","#AA0DFE","#FC1CBF","#1CFFCE","#F6222E","#85660D","#325A9B","#B10DA1","#A0A0A0","#782AB6","#565656"],paletteExceptions:{start:"#C8C8C8",ends:"#C8C8C8",unreachable:"#FF6666",untagged:"#FFFFFF",trace:"#FF8000",default:"#FFFFFF",leafHue:.3,readHue:.22}},n=["StoryTitle","StoryIncludes","StoryData","StoryAuthor","StorySubtitle","StoryMenu","StorySettings","StoryColophon","StoryBanner","StoryCaption","StoryInit","StoryShare","PassageDone","PassageFooter","PassageHeader","PassageReady","MenuOptions","MenuShare","DotGraphSettings"],o=["annotation","debug-footer","debug-header","debug-startup","footer","haml","header","script","startup","stylesheet","twee2","transition","Twine.private","widget"],a={title:"Untitled",startNode:1,startNodeName:"Start",leaves:0,links:0,tightEnds:0,avLength:1,maxLength:1,passages:[],reachable:[],tags:[],tagObject:[],targets:{},twineVersion:0},s=new Viz;e.graph=function(){function n(e){if("#"!=e.charAt(0)||(e.length-1)%3!=0)return"#000000";var t=[];return t=e.length-1==3?[e.charAt(1),e.charAt(2),e.charAt(3)]:[e.substring(1,3),e.substring(3,5),e.substring(5,7)],t=t.map(function(e){return parseInt(e,16)/255}),.299*t[0]+.587*t[1]+.114*t[2]>.5?"#000000":"#ffffff"}function o(){e.settings.parse(),e.story.parse();var t=d();document.getElementById("dotfile").value=t,f(t)}function r(){f(document.getElementById("dotfile").value)}function i(){var e=document.getElementById("dotfile").value,n=new Blob([e],{type:"text/plain;charset=utf-8"});filesaver.saveAs(n,"dot"+Date.now()+"."+t.dotExtension,!0)}function c(){var e=document.getElementById("graph").firstChild.outerHTML,t=new Blob([e],{type:"image/svg+xml;charset=utf-8"});filesaver.saveAs(t,"dotgraph"+Date.now()+".svg",!0)}function l(e){var n=document.getElementsByTagName("svg")[0];if(n.removeAttribute("height"),t.scale){if(void 0!==e){var o=t.scale.split(/(\d+)/),a=o[o.length-1];t.scale=parseInt(parseInt(n.getAttribute("width"),10)*(1+e),10)+a}}else{var s=n.getAttribute("viewBox").split(" ");t.scale=void 0===e?s[2]+"pt":parseFloat(n.getAttribute("width"))+parseFloat(s[2])*e+"pt"}n.setAttribute("width",t.scale),document.getElementById("scaleInput").value=t.scale}function d(){var e=[];return e.push("digraph "+x(a.title)+" {"),e.push("rankdir="+t.rotation+"\r\n"),t.cluster&&(e=e.concat(v(a.tagObject))),"tag"==t.color&&a.tags.length!=t.clusterTags.length&&(e=e.concat(w(a,t))),e=e.concat(b()),e.push('\nlabelloc="t"\n'),e.push("label="+x(a.title)),e.push("\n}"),e.join("\r\n")}function u(e){return a.targets.hasOwnProperty(e)?a.targets[e]:x(e)}function g(e,n){for(var o=[],a=0;a<e.links.length;a++){var s=e.links[a][0],r=n+" -> "+(t.showNodeNames?x(s):u(s));e.links[a][1]&&(r+=" [style = dashed]"),o.push(r)}return o}function h(e,n,o,a){var s;return s=(n?!t.showNodeNames:t.showNodeNames)?e.name:e.pid?e.pid:"Untitled Passage",o&&t.countWords&&(s+=" ("+e.wordCount+" word"+(1==e.wordCount?"":"s")+")"),a&&(s=t.prefix+s+t.postfix),x(s)}function p(e){return t.showNodeNames?x(e):u(e)}function m(e,t,n){return e.toFixed(2)+","+t.toFixed(2)+","+n.toFixed(2)}function b(){var e=[];if(t.renumber&&!t.showNodeNames){var n;for(n=0;n<a.passages.length;++n)a.passages[n].pid==a.startNode&&(e=e.concat(k(a.passages[n],1)));var o=2;for(n=0;n<a.passages.length;++n){var s=a.passages[n];s.pid==a.startNode||t.omitSpecialPassages&&s.special||s.omit||(e=e.concat(k(s,o)),o++)}}else for(n=0;n<a.passages.length;++n)a.passages[n].omit||(e=e.concat(k(a.passages[n])));return e}function k(e,n){var o=[];if(t.omitSpecialPassages&&e.special||e.omit)return o;var a=h(e),s=y(e,n),r=g(e,a);return o.push("\r\n"+a+" ["+s.join(" ")+"]"),o=o.concat(r)}function f(n){document.getElementById("graph").innerHTML="",s.renderSVGElement(n,{engine:t.engine}).then(function(n){document.getElementById("graph").appendChild(n),e.graph.scale(),t.snowstick&&document.querySelectorAll("#graph g.node text").forEach(function(t){t.addEventListener("click",e.settings.bookmark,!1)})}).catch(function(e){s=new Viz,console.log(e)})}function y(n,o){var s=[],r=0,i=0,c=1,l=n.pid,d=(n.content,n.theTag);if(t.snowstick&&n.ssBookmark?s.push("shape=note"):n.trace?s.push("shape=hexagon"):l==a.startNode||_.find(a.unreachable,function(e){return e==n.name})?s.push("shape=doublecircle"):t.ends&&e.passage.hasTag(n,t.endTag)?s.push("shape=egg"):t.checkpoints&&e.passage.hasTag(n,t.checkpointTag)&&s.push("shape=diamond"),0===s.length&&0===n.links.length&&t.ends?s.push('style="filled,diagonals"'):s.length?s.push('style="filled,bold"'):"bw"!=t.color&&s.push("style=filled"),"length"==t.color)r=Math.round(100*Math.min(1.75,n.textLength/a.avLength)/3)/100,s.push('fillcolor="'+r+',0.66,0.85"');else if("tag"==t.color&&d){var u=a.tags.indexOf(d);u>-1&&(r=t.palette[u%26]),s.push('fillcolor="'+r+'"'),s.push('fontcolor="'+t.paletteContrastColors[u%26]+'"')}else"tag"==t.color||(t.snowstick&&n.ssLeaf&&(t.ends&&e.passage.hasTag(n,t.endTag)||n.leaf)?(r=t.paletteExceptions.leafHue,s.push('fillcolor="'+m(r,.9,.5)+'"')):t.snowstick&&n.ssLeaf?(r=t.paletteExceptions.leafHue,i=n.ssLeaf,c=Math.round(100*n.ssLeaf/5)/100+.5,s.push('fillcolor="'+m(r,i,c)+'"')):n.trace?s.push('fillcolor="'+t.paletteExceptions.trace+'"'):t.snowstick&&n.ssRead?(r=t.paletteExceptions.readHue,i=n.ssRead,c=Math.round(100*n.ssRead/5)/100+.79,s.push('fillcolor="'+m(r,i,c)+'"')):l==a.startNode?s.push('fillcolor="'+t.paletteExceptions.start+'"'):t.ends&&e.passage.hasTag(n,t.endTag)?s.push('fillcolor="'+t.paletteExceptions.ends+'"'):_.find(a.unreachable,function(e){return e==n.name})?s.push('fillcolor="'+t.paletteExceptions.unreachable+'"'):"tag"==t.color?s.push('fillcolor="'+t.paletteExceptions.untagged+'"'):s.push('fillcolor="'+t.paletteExceptions.default+'"'));return(o||t.prefix||t.postfix)&&(o?s.push('label="'+t.prefix+o+t.postfix+'"'):s.push("label="+h(n,!1,!1,!0))),t.tooltips&&s.push("tooltip="+h(n,!0,!0)),s}function x(e){return e&&(e=e.toString().replace(/"/gm,'\\"'),e='"'+e+'"'),e}function v(n){var o=[],a=0;for(var s in n)n.hasOwnProperty(s)&&!e.settings.isOmittedTag(s)&&(0==t.clusterTags.length||t.clusterTags.indexOf(s)>-1)&&(o.push("subgraph cluster_"+a+" {"),o.push("label="+x(s)),o.push('style="rounded, filled" fillcolor="ivory"'),o.push(n[s].map(p).join(" \r\n")),o.push("}\r\n"),a++);return o}function w(t,n){for(var o,s=['{rank=source\r\nstyle="rounded, filled"'],r=0;r<t.tags.length;r++)e.settings.isOmittedTag(a.tags[r])||(o=x(a.tags[r]),s.push(o+' [shape=rect style="filled,rounded" fillcolor="'+n.palette[r%26]+'" fontcolor="'+n.paletteContrastColors[r%26]+'"]'));s.push("}");var i=n.showNodeNames?x(t.startNodeName):t.startNode;for(r=0;r<t.tags.length;r++)e.settings.isOmittedTag(t.tags[r])||s.push(x(t.tags[r])+" -> "+i+" [style=invis]");return s}return{contrastColor:n,convert:o,edit:r,saveDot:i,saveSvg:c,scale:l}}(),e.init=function(){function n(){e.settings.load(),e.settings.write(),e.settings.toggle(),o(),e.graph.convert(),window.location.search&&window.location.search.split("?")[1].length>0&&e.story.load(window.location.search.split("?")[1])}function o(){document.getElementById("settingsForm").addEventListener("click",e.graph.convert,!1),document.getElementById("clusterTags").addEventListener("input",_.debounce(e.graph.convert,1e3),!1),document.getElementById("omitTags").addEventListener("input",_.debounce(e.graph.convert,1e3),!1),document.getElementById("trace").addEventListener("input",_.debounce(e.graph.convert,1e3),!1),document.getElementById("editButton").addEventListener("click",e.graph.edit,!1),document.getElementById("saveDotButton").addEventListener("click",e.graph.saveDot,!1),document.getElementById("saveSvgButton").addEventListener("click",e.graph.saveSvg,!1),document.getElementById("scaleInput").addEventListener("change",function(){e.settings.scale()},!1),document.getElementById("scaleUpButton").addEventListener("click",function(){e.graph.scale(t.increment)},!1),document.getElementById("scaleDownButton").addEventListener("click",function(){e.graph.scale(-t.increment)},!1),document.getElementById("dotHeader").addEventListener("click",function(){e.settings.toggle("dotSection")},!1),document.getElementById("settingsHeader").addEventListener("click",function(){e.settings.toggle("settingsSection")},!1)}return{load:n}}(),e.passage=function(){function o(e,t){return e.tagArray.indexOf(t)>-1}function a(e,o){var a={},i=e.getAttribute("tags")?e.getAttribute("tags").trim().split(" "):[],l=c(e.innerText);return a.content=e.innerText,a.links=l,a.leaf=0===l.length,a.textLength=e.innerText.length,a.wordCount=e.innerText.trim()?e.innerText.trim().split(/\s+/).length:0,a.pid=e.getAttribute("pid")?e.getAttribute("pid"):o,a.tagArray=i,a.theTag=s(i),a.name=e.getAttribute("name")?e.getAttribute("name"):e.getAttribute("tiddler")?e.getAttribute("tiddler"):"Untitled Passage",a.special=n.indexOf(a.name)>-1,a.omit=r(a),a.trace=t.trace&&e.innerText.indexOf(t.trace)>-1,t.snowstick&&(a.ssLeaf=Math.max(t.snowstickObj.leaf.indexOf(a.name),0)/Math.max(t.snowstickObj.leaf.length,1),a.ssRead=Math.max(t.snowstickObj.read.indexOf(a.name),0)/Math.max(t.snowstickObj.read.length,1),a.ssBookmark=t.snowstickObj.bookmark==a.name),a}function s(e){var n=e.slice(0);return t.ends&&n.indexOf(t.endTag)>-1&&n.splice(n.indexOf(t.endTag),1),t.checkpoints&&n.indexOf(t.checkpointTag)>-1&&n.splice(n.indexOf(t.checkpointTag),1),n.length&&t.lastTag?n[n.length-1]:n.length?n[0]:""}function r(n){if(0==t.omitTags.length&&0==t.omitSpecialTags)return!1;for(var o=0;o<n.tagArray.length;o++)if(e.settings.isOmittedTag(n.tagArray[o]))return!0;return!1}function i(e,t){var n=e.indexOf("|");if(-1!=n)e=e.substr(n+1);else{var o=e.indexOf("->");if(-1!=o)e=e.substr(o+2);else{var a=e.indexOf("<-");-1!=a&&(e=e.substr(0,a))}}return[e,t]}function c(e){var n,o,a,s=[],r=/\[\[(.*?)\]\]/g,c=/\<\<display \"(.*?)\"\>\>/g,l=/\(display: \"(.*?)\"\)/g;if(e){for(e=e.replace(/\/\*.*\*\//g,""),e=e.replace(/^\/\/.*(\r\n?|\n)/g,"");null!==(n=r.exec(e));)o=i(n[1],0),/^\w+:\/\/\/?\w/i.test(o)||s.push(o);if(t.display){for(;null!==(n=c.exec(e));)a=i(n[1],1),/^\w+:\/\/\/?\w/i.test(a)||s.push(a);for(;null!==(n=l.exec(e));)a=i(n[1],1),/^\w+:\/\/\/?\w/i.test(a)||s.push(a)}}return s}return{hasTag:o,parse:a}}(),e.settings=function(){function n(e){var n=e.target.innerHTML;if(t.showNodeNames&&n){var o=window.document.querySelector("tw-storydata")?"-"+window.document.querySelector("tw-storydata").getAttribute("ifid").toUpperCase():"";try{localStorage.setItem("snowstick-bookmark"+o,n),t.snowstickObj.bookmark=localStorage.getItem("snowstick-bookmark"+o)?localStorage.getItem("snowstick-bookmark"+o):""}catch(e){console.log("Bookmarking failed.")}}}function a(e){return(0!=t.omitTags.length||0!=t.omitSpecialTags)&&(t.omitTags.indexOf(e)>-1||!!(t.omitSpecialTags&&o.indexOf(e)>-1))}function s(){try{var e=window.document.querySelector("tw-storydata")?"-"+window.document.querySelector("tw-storydata").getAttribute("ifid").toUpperCase():"";t.snowstickObj.read=localStorage.getItem("snowstick-read"+e)?JSON.parse(localStorage.getItem("snowstick-read"+e)):[],t.snowstickObj.leaf=localStorage.getItem("snowstick-leaf"+e)?JSON.parse(localStorage.getItem("snowstick-leaf"+e)):[],t.snowstickObj.bookmark=localStorage.getItem("snowstick-bookmark"+e)?localStorage.getItem("snowstick-bookmark"+e):"",t.snowstick=t.snowstickObj.leaf.length>0||t.snowstickObj.read.length>0||t.snowstickObj.bookmark.length>0}catch(e){t.snowstick=!1,console.log("Error checking local storage for SnowStick data: "+e.description)}var n;if(n=window.document.getElementById("storeArea")?window.document.getElementById("storeArea").querySelector('div[tiddler="DotGraphSettings"]'):window.document.querySelector('tw-passagedata[name="DotGraphSettings"]'))a=n.innerText;else{var o,a;(o=window.document.getElementById("storeArea")?window.document.getElementById("storeArea").querySelector('div[tiddler="StorySettings"]'):window.document.querySelector('tw-passagedata[name="StorySettings"]'))&&o.innerText&&o.innerText.indexOf("dotgraph:")>-1&&(a=o.innerText.split("dotgraph:")[1].split("\n")[0])}if(a)try{a=JSON.parse(a)}catch(e){return void console.log("Found but couldn't parse dotgraph settings: "+a)}_.each(a,function(e,n){"snowstick"==n&&e||(t[n]=e)}),d()}function r(){t.checkpoints=!!document.getElementById("checkpointsCheckbox")&&document.getElementById("checkpointsCheckbox").checked,t.cluster=!!document.getElementById("clusterCheckbox")&&document.getElementById("clusterCheckbox").checked,t.clusterTags=document.getElementById("clusterTags")?u(document.getElementById("clusterTags").value):[],t.color=document.querySelector("input[name='colorCheckbox']:checked")?document.querySelector("input[name='colorCheckbox']:checked").value:"length",t.display=!document.getElementById("displayCheckbox")||document.getElementById("displayCheckbox").checked,t.ends=!!document.getElementById("endsCheckbox")&&document.getElementById("endsCheckbox").checked,t.engine=document.querySelector("input[name='engineCheckbox']:checked")?document.querySelector("input[name='engineCheckbox']:checked").value:"dot",t.omitSpecialPassages=!!document.getElementById("specialCheckbox")&&document.getElementById("specialCheckbox").checked,t.omitSpecialTags=!!document.getElementById("specialTagCheckbox")&&document.getElementById("specialTagCheckbox").checked,t.renumber=!!document.getElementById("renumberCheckbox")&&document.getElementById("renumberCheckbox").checked,t.rotation=document.querySelector("input[name='rotateCheckbox']:checked")?document.querySelector("input[name='rotateCheckbox']:checked").value:"TB",t.scale=document.getElementById("scaleInput")?document.getElementById("scaleInput").value:"",t.showNodeNames=!!document.getElementById("nodeCheckbox0")&&document.getElementById("nodeCheckbox0").checked,t.omitTags=document.getElementById("omitTags")?u(document.getElementById("omitTags").value):[],t.lastTag=!!document.getElementById("lastTagCheckbox")&&document.getElementById("lastTagCheckbox").checked,t.countWords=!!document.getElementById("wcCheckbox")&&document.getElementById("wcCheckbox").checked,t.trace=document.getElementById("trace")?g(document.getElementById("trace").value):""}function i(){t.scale=document.getElementById("scaleInput")?document.getElementById("scaleInput").value:"",e.graph.scale()}function c(e){e?document.getElementById(e).style.display=document.getElementById(e).offsetParent?"none":"":(t.hideDot&&(document.getElementById("dotSection").style.display="none"),t.hideSettings&&(document.getElementById("settingsSection").style.display="none"))}function l(){var e=_.template('<input type="radio" id="nodeCheckbox0" name="nodeCheckbox" value="names" <%= (showNodeNames ? "checked" : "") %>/><label for="nodeCheckbox">&nbsp;Passage titles</label> \t\t\t<input type="radio" id="nodeCheckbox1" name="nodeCheckbox" value="pid"  <%= (showNodeNames ? "" : "checked") %> /><label for="nodeCheckbox">&nbsp;Passage ids (hover for title)</label> \t\t\t<input type="checkbox" id="renumberCheckbox" name="renumberCheckbox" <%= (renumber ? "checked" : "") %>/><label for="renumberCheckbox">&nbsp;renumber from 1</label><br /> \t\t\t<input type="radio" id="colorCheckbox0" name="colorCheckbox" value="bw" <%= (color == "bw" ? "checked" : "")%> />&nbsp;<label for="colorCheckbox0">Black & white</label> \t\t\t<input type="radio" id="colorCheckbox1" name="colorCheckbox" value="length" <%= (color == "length" ? "checked" : "")%> />&nbsp;<label for="colorCheckbox1">Color by node length</label> \t\t\t<input type="radio" id="colorCheckbox2" name="colorCheckbox" value="tag" <%= (color == "tag" ? "checked" : "")%>/>&nbsp;<label for="colorCheckbox2">Color by tag</label> '+(t.snowstick?'<input type="radio" id="colorCheckbox3" name="colorCheckbox" value="snow" <%= (color == "snow" ? "checked" : "")%>/>&nbsp;<label for="colorCheckbox3" title="SnowStick">Color by read state</label>':"")+'<br/> \t\t\t<input type="checkbox" id="displayCheckbox" name="displayCheckbox" checked/>&nbsp;<label for="displayCheckbox">Include display macro links</label> \t\t\t<input type="checkbox" id="wcCheckbox" name="wcCheckbox" <%= (countWords ? "checked" : "") %> />&nbsp;<label for="wcCheckbox">Include word counts (hover)</label><br/> \t\t\t<input type="checkbox" id="specialCheckbox" <%= (omitSpecialPassages ? "checked" : "") %> />&nbsp;<label for="specialCheckbox">Omit&nbsp;special&nbsp;passages</label> (StoryTitle,&nbsp;etc.) \t\t\t<input type="checkbox" id="specialTagCheckbox" <%= (omitSpecialTags ? "checked" : "") %> />&nbsp;<label for="specialTagCheckbox">Omit&nbsp;by&nbsp;special&nbsp;tags</label> (script,&nbsp;etc.)<br/> \t\t\t<input type="radio" id="omitTagsFakeRadioButton" disabled/>&nbsp;<label for="omitTags">Omit by tag(s):</label>&nbsp;<input type="text" id="omitTags" placeholder="Separate tags with commas." value="<%=omitTags.join(", ")%>"/><br/> \t\t\t<input type="checkbox" id="checkpointsCheckbox" <%= (checkpoint ? "checked" : "") %> />&nbsp;<label for="checkpointsCheckbox" title="This changes the shape of checkpoint passages to a diamond.">Detect checkpoint tags</label> \t\t\t<input type="checkbox" id="endsCheckbox" <%= (ends == true ? "checked" : "") %>/>&nbsp;<label for="endsCheckbox" title="This changes the shape of end passages to an egg and puts diagonals on loose ends and disconnected nodes.">Detect end tags</label> \t\t\t<input type="checkbox" id="lastTagCheckbox" <%= (lastTag ? "checked" : "") %> />&nbsp;<label for="lastTagCheckbox" title="The cluster and color by tag options normally use the first tag on each passage.">Use last tag</label><br/> \t\t\t<input type="checkbox" id="clusterCheckbox" <%= (cluster ? "checked" : "") %> />&nbsp;<label for="clusterCheckbox">Cluster by tags:</label>&nbsp;<input type="text" id="clusterTags" placeholder="Separate tags with commas; leave blank for all tags." value="<%=clusterTags.join(", ")%>"/><br/> \t\t\t<input type="radio" id="traceFakeRadioButton" disabled/>&nbsp;<label for="trace" title="Traced nodes are hex-shaped.">Trace phrase:</label>&nbsp;<input type="input" id="trace" value="<%=trace%>" /> <br/> \t\t\t<input type="radio" id="engineCheckbox0" name="engineCheckbox" value="circo" <%= (engine == "circo" ? "checked" : "")%> />&nbsp;<label for="engineCheckbox0">circo</label> \t\t\t<input type="radio" id="engineCheckbox1" name="engineCheckbox" value="dot" <%= (engine == "dot" ? "checked" : "")%> />&nbsp;<label for="engineCheckbox1">dot</label> \t\t\t(<input type="radio" id="rotateCheckbox0" name="rotateCheckbox" value="TB" <%= (rotation == "TB" ? "checked" : "")%> />&nbsp;<label for="rotateCheckbox0" title="Top to bottom">&darr;</label> \t\t\t<input type="radio" id="rotateCheckbox1" name="rotateCheckbox" value="LR" <%= (rotation == "LR" ? "checked" : "")%> />&nbsp;<label for="rotateCheckbox1" title="Left to right">&rarr;</label> \t\t\t<input type="radio" id="rotateCheckbox2" name="rotateCheckbox" value="BT" <%= (rotation == "BT" ? "checked" : "")%> />&nbsp;<label for="rotateCheckbox2" title="Bottom to top">&uarr;</label> \t\t\t<input type="radio" id="rotateCheckbox3" name="rotateCheckbox" value="RL" <%= (rotation == "RL" ? "checked" : "")%> />&nbsp;<label for="rotateCheckbox3" title="Right to left">&larr;</label>) \t\t\t<input type="radio" id="engineCheckbox2" name="engineCheckbox" value="fdp" <%= (engine == "fdp" ? "checked" : "")%>/>&nbsp;<label for="engineCheckbox2">fdp</label> \t\t\t<input type="radio" id="engineCheckbox3" name="engineCheckbox" value="neato" <%= (engine == "neato" ? "checked" : "")%>/>&nbsp;<label for="engineCheckbox3">neato</label> \t\t\t<input type="radio" id="engineCheckbox4" name="engineCheckbox" value="osage" <%= (engine == "osage" ? "checked" : "")%>/>&nbsp;<label for="engineCheckbox4">osage</label> \t\t\t<input type="radio" id="engineCheckbox5" name="engineCheckbox" value="twopi" <%= (engine == "twopi" ? "checked" : "")%>/>&nbsp;<label for="engineCheckbox5">twopi</label><br/>');document.getElementById("settingsForm").innerHTML=e(t),document.getElementById("scaleInput").value=t.scale}function d(){t.paletteContrastColors=t.palette.map(function(t){return e.graph.contrastColor(t)})}function u(e){for(var t=e.trim().split(","),n=[],o=0;o<t.length;o++){var a=t[o].trim();""!=a&&n.push(a)}return document.getElementById("omitTagsFakeRadioButton").checked=n.length>0,n}function g(e){return e=e.trim(),document.getElementById("traceFakeRadioButton").checked=e.length>0,e}return{bookmark:n,isOmittedTag:a,load:s,parse:r,scale:i,toggle:c,write:l}}(),e.story=function(){function n(e,t){if(document.querySelector("tw-storydata, div#storeArea")&&document.querySelector("tw-storydata, div#storeArea").remove(),t||(document.getElementById("graph").innerHTML="<p style='text-align:center;'><i>Loading</i> <tt>"+e+"</tt> ...<span id='loadingResult' style='color:tomato;'></span><p>"),e){e=e.indexOf("t.co/")>0||e.indexOf("tads.org/")>0?"https://mcdemarco.net/games/bgg/proxy.php?csurl="+e:"https://cors-anywhere.herokuapp.com/"+e;var n=new XMLHttpRequest;n.onreadystatechange=o,n.open("GET",e),n.responseType="document",n.send()}}function o(){if(4!=this.readyState||200!=this.status&&304!=this.status)return void(document.getElementById("loadingResult").innerHTML=" not found.");var n=this.response.querySelector("tw-storydata, div#storeArea");if(!n){var o,a=this.response.url?this.response.url:this.responseURL?this.responseURL:"";if(this.response.querySelector("meta[http-equiv=refresh]")){var s=this.response.querySelector("meta[http-equiv=refresh]").getAttribute("content");s&&(o=s.split(";URL=")[1])}else a.indexOf("philome.la/")>-1&&a.indexOf("/play")<0?o=a+"/play":a.indexOf("itch.io")>0?(o=this.response.querySelector("iframe[src]").getAttribute("src"),o.indexOf("http")<0&&(o="https:"+o)):a.indexOf("ifdb.tads.org")>0&&(o=this.response.querySelector("div#links-div a"))&&(o=o.getAttribute("href"));return void(o?e.story.load(o,!0):document.getElementById("loadingResult").innerHTML=" failed.")}document.querySelector("body").append(n),t.scale="",n.children&&n.children.length&&n.children.length<20?t.showNodeNames=!0:t.showNodeNames=!1,e.settings.write(),e.graph.convert()}function s(){var n,o,s=window.document.getElementById("storeArea"),c=window.document.getElementsByTagName("tw-storydata")[0];if(s){a.twineVersion=1;var l="Untitled Story";s.querySelectorAll('[tiddler="StoryTitle"]').length&&(l=s.querySelectorAll('[tiddler="StoryTitle"]')[0].innerText),a.title=l}else c?(a.twineVersion=2,a.title=c.getAttribute("name")?c.getAttribute("name"):"Untitled",a.startNode=c.getAttribute("startnode")?c.getAttribute("startnode"):1):(a.title="Story not found",a.startNode="");for(o=s?s.querySelectorAll("div[tiddler]"):document.querySelectorAll("tw-passagedata"),a.passages=r(o),a.leaves=0,a.links=0,a.tightEnds=0,a.tagObject={},a.tags=[],a.targets={},n=0;n<a.passages.length;n++){var d=a.passages[n];s&&"Start"==d.name&&(a.startNode=n),t.ends&&e.passage.hasTag(d,t.endTag)&&a.tightEnds++,d.pid==a.startNode&&(a.startNodeName=d.name,a.reachable.push(d.name)),d.theTag&&(a.tagObject.hasOwnProperty(d.theTag)||(a.tagObject[d.theTag]=[],a.tags.push(d.theTag)),a.tagObject[d.theTag].push(d.name)),a.targets[d.name]=d.pid,a.links+=d.links.length,a.reachable=a.reachable.concat(_.map(d.links,_.first)),!d.leaf||d.omit||d.special&&t.omitSpecialPassages||a.leaves++}a.unreachable=_.difference(a.reachable,_.uniq(a.reachable)),a.reachable=_.uniq(a.reachable),a.maxLength=a.passages.reduce(function(e,t){return Math.max(e,t.textLength)},1),a.avLength=a.passages.reduce(function(e,t){return e+t.textLength},0)/a.passages.length,i()}function r(t){for(var n=[],o=0;o<t.length;o++)n[o]=e.passage.parse(t[o],o);return n}function i(){if(document.getElementById("nodeCount").innerHTML=a.passages.length,t.omitSpecialPassages||t.omitTags.length>0){var e=a.passages.reduce(function(e,n){return e+(n.special&&t.omitSpecialPassages||n.omit?1:0)},0);document.getElementById("omitCount").innerHTML=" ("+(a.passages.length-e)+" included, "+e+" omitted, "+a.unreachable.length+" unreachable)"}if(document.getElementById("leafCount").innerHTML=a.leaves,t.ends){var n=a.leaves-a.tightEnds;document.getElementById("looseCount").innerHTML=" (including "+(n>0?n:0)+" loose end"+(1!=n?"s":"")+")"}else document.getElementById("looseCount").innerHTML="";document.getElementById("linkCount").innerHTML=a.links,document.getElementById("average").innerHTML=Math.round(a.links/Math.max(a.passages.length,1)*100)/100,document.getElementById("stats").setAttribute("title","Twine "+a.twineVersion)}return{load:n,parse:s}}()}(dotGraph),window.onload=dotGraph.init.load();
},{"filesaver.js-npm":1,"underscore":2}]},{},[3]);
</script>
</body>
</html>
